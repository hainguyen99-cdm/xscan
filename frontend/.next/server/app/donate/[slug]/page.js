(()=>{var e={};e.id=5157,e.ids=[5157],e.modules={47849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},55403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},94749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},25528:e=>{"use strict";e.exports=require("next/dist\\client\\components\\action-async-storage.external.js")},91877:e=>{"use strict";e.exports=require("next/dist\\client\\components\\request-async-storage.external.js")},25319:e=>{"use strict";e.exports=require("next/dist\\client\\components\\static-generation-async-storage.external.js")},39491:e=>{"use strict";e.exports=require("assert")},6113:e=>{"use strict";e.exports=require("crypto")},82361:e=>{"use strict";e.exports=require("events")},57147:e=>{"use strict";e.exports=require("fs")},13685:e=>{"use strict";e.exports=require("http")},95687:e=>{"use strict";e.exports=require("https")},71017:e=>{"use strict";e.exports=require("path")},12781:e=>{"use strict";e.exports=require("stream")},76224:e=>{"use strict";e.exports=require("tty")},57310:e=>{"use strict";e.exports=require("url")},73837:e=>{"use strict";e.exports=require("util")},59796:e=>{"use strict";e.exports=require("zlib")},586:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>o.a,__next_app__:()=>m,originalPathname:()=>u,pages:()=>c,routeModule:()=>x,tree:()=>d});var s=r(7),a=r(8533),n=r(29377),o=r.n(n),i=r(29799),l={};for(let e in i)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>i[e]);r.d(t,l);let d=["",{children:["donate",{children:["[slug]",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,532)),"D:\\repo\\xscan\\frontend\\src\\app\\donate\\[slug]\\page.tsx"]}]},{}]},{}]},{layout:[()=>Promise.resolve().then(r.bind(r,44161)),"D:\\repo\\xscan\\frontend\\src\\app\\layout.tsx"],error:[()=>Promise.resolve().then(r.bind(r,12873)),"D:\\repo\\xscan\\frontend\\src\\app\\error.tsx"],"not-found":[()=>Promise.resolve().then(r.bind(r,34392)),"D:\\repo\\xscan\\frontend\\src\\app\\not-found.tsx"]}],c=["D:\\repo\\xscan\\frontend\\src\\app\\donate\\[slug]\\page.tsx"],u="/donate/[slug]/page",m={require:r,loadChunk:()=>Promise.resolve()},x=new s.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/donate/[slug]/page",pathname:"/donate/[slug]",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},9500:(e,t,r)=>{Promise.resolve().then(r.bind(r,39675))},39675:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>h,dynamic:()=>p});var s=r(54714),a=r(77580),n=r(88934),o=r(46475),i=r(27114),l=r(83446),d=r(42708),c=r(12448),u=r(90368),m=r(53278),x=r(56825);let p="force-dynamic",g=[5e4,1e5,25e4,5e5,1e6,25e5,5e6];function h(){var e;let t=(0,n.useParams)(),r=(0,n.useRouter)(),[p,h]=(0,a.useState)(null),[f,y]=(0,a.useState)(!0),[v,b]=(0,a.useState)({amount:0,currency:"VND",message:"",isAnonymous:!1,paymentMethod:"wallet"}),[j,N]=(0,a.useState)(""),[w,k]=(0,a.useState)(!1);(0,a.useEffect)(()=>{(async()=>{let e=t.slug;if(!e){(0,c.showToast)({type:"error",title:"Invalid URL",message:"Donation link not found.",duration:5e3}),r.push("/donate-for-streamers");return}try{y(!0);let t=await fetch(`/api/donate/${e}`);if(!t.ok){if(404===t.status){(0,c.showToast)({type:"error",title:"Donation Link Not Found",message:"The donation link you are looking for could not be found.",duration:5e3}),r.push("/donate-for-streamers");return}throw Error("Failed to fetch donation link")}let s=await t.json();if(!s.success||!s.data)throw Error(s.message||"Failed to fetch donation link");let a=s.data;if(!a.isActive){(0,c.showToast)({type:"error",title:"Donation Link Inactive",message:"This donation link is currently inactive.",duration:5e3}),r.push("/donate-for-streamers");return}let n={id:a.streamerId?._id||a._id,name:a.streamerId?`${a.streamerId.firstName||""} ${a.streamerId.lastName||""}`.trim()||a.streamerId.username||a.title:a.title||"Unknown Streamer",username:a.streamerId?.username||a.slug||a.customUrl,avatar:a.streamerId?.profilePicture,totalDonations:a.totalAmount||0,isLive:!1,category:"general",followers:a.followers||0,streamTitle:void 0,game:void 0,donationLink:a};h(n)}catch(e){console.error("Error fetching donation link:",e),(0,c.showToast)({type:"error",title:"Error",message:"Failed to load donation link. Please try again.",duration:5e3}),r.push("/donate-for-streamers")}finally{y(!1)}})()},[t.slug,r]);let D=e=>{v.amount===e?b(e=>({...e,amount:0})):b(t=>({...t,amount:e})),N("")},C=e=>{N(e);let t=parseFloat(e)||0;b(e=>({...e,amount:t}))},A=async e=>{if(e.preventDefault(),v.amount<1e4){(0,c.showToast)({type:"error",title:"Invalid Amount",message:"Minimum donation amount is 10,000 VND.",duration:5e3});return}if(v.isAnonymous&&!p?.donationLink.allowAnonymous){(0,c.showToast)({type:"error",title:"Anonymous Donations Not Allowed",message:"This streamer does not allow anonymous donations.",duration:5e3});return}k(!0);try{let e=await fetch("/api/donations/process",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({donationLinkId:p?.donationLink._id||p?.donationLink.id,streamerId:p?.id,amount:v.amount,currency:v.currency,message:v.message,isAnonymous:v.isAnonymous,paymentMethod:v.paymentMethod})});if(!e.ok){let t=await e.json();throw Error(t.message||"Failed to process donation")}await e.json(),(0,c.showToast)({type:"success",title:"Donation Successful!",message:`Thank you for your ${v.amount.toLocaleString()} VND donation to ${p?.name}!`,duration:5e3}),b({amount:0,currency:"VND",message:"",isAnonymous:!1,paymentMethod:"wallet"}),N("")}catch(t){console.error("Donation error:",t);let e=t instanceof Error?t.message:"There was an error processing your donation. Please try again.";(0,c.showToast)({type:"error",title:"Donation Failed",message:e,duration:5e3})}finally{k(!1)}};return f?s.jsx(u.Z,{children:s.jsx("div",{className:"flex justify-center items-center min-h-screen",children:s.jsx(d.T,{size:"lg"})})}):p?s.jsx(u.Z,{children:(0,s.jsxs)("div",{className:"max-w-4xl mx-auto px-4 py-6",children:[(0,s.jsxs)(o.z,{variant:"outline",onClick:()=>r.push("/donate-for-streamers"),className:"mb-6",children:[s.jsx(m.Z,{className:"h-4 w-4 mr-2"}),"Back to Streamers"]}),s.jsx(l.Zb,{className:"mb-8",children:(0,s.jsxs)(l.Ol,{className:"text-center",children:[(0,s.jsxs)("div",{className:"flex items-center justify-center mb-4",children:[s.jsx("div",{className:"h-20 w-20 rounded-full bg-gradient-to-r from-indigo-600 to-cyan-500 flex items-center justify-center text-white font-bold text-2xl mr-4",children:p.name.charAt(0).toUpperCase()}),(0,s.jsxs)("div",{children:[s.jsx(l.ll,{className:"text-3xl",children:p.name}),(0,s.jsxs)(l.SZ,{className:"text-lg",children:["@",p.username]})]})]}),p.isLive&&(0,s.jsxs)("div",{className:"inline-flex items-center px-4 py-2 bg-red-100 text-red-800 rounded-full mb-4",children:[s.jsx("div",{className:"w-2 h-2 bg-red-500 rounded-full mr-2 animate-pulse"}),"LIVE NOW"]}),p.isLive&&p.streamTitle&&(0,s.jsxs)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 mb-4",children:[s.jsx("p",{className:"text-red-800 font-medium mb-1",children:"Currently Streaming:"}),s.jsx("p",{className:"text-red-700",children:p.streamTitle}),p.game&&(0,s.jsxs)("p",{className:"text-red-600 text-sm mt-1",children:["\uD83C\uDFAE ",p.game]})]}),p.donationLink.description&&s.jsx("div",{className:"mb-4 p-4 bg-gray-50 rounded-lg",children:s.jsx("p",{className:"text-gray-700",children:p.donationLink.description})}),(0,s.jsxs)("div",{className:"grid grid-cols-3 gap-4 text-center",children:[(0,s.jsxs)("div",{children:[s.jsx("div",{className:"text-2xl font-bold text-indigo-600",children:(e=p.followers)>=1e6?(e/1e6).toFixed(1)+"M":e>=1e3?(e/1e3).toFixed(1)+"K":e.toString()}),s.jsx("div",{className:"text-gray-600",children:"Followers"})]}),(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:"text-2xl font-bold text-green-600",children:[p.totalDonations.toLocaleString()," VND"]}),s.jsx("div",{className:"text-gray-600",children:"Total Donations"})]}),(0,s.jsxs)("div",{children:[s.jsx("div",{className:"text-2xl font-bold text-purple-600",children:p.category}),s.jsx("div",{className:"text-gray-600",children:"Category"})]})]})]})}),(0,s.jsxs)(l.Zb,{children:[(0,s.jsxs)(l.Ol,{children:[s.jsx(l.ll,{className:"text-2xl text-center",children:"Make a Donation"}),(0,s.jsxs)(l.SZ,{className:"text-center",children:["Support ",p.name," and help them continue creating amazing content"]})]}),s.jsx(l.aY,{children:(0,s.jsxs)("form",{onSubmit:A,className:"space-y-6",children:[(0,s.jsxs)("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Select Donation Amount"}),s.jsx("div",{className:"grid grid-cols-4 gap-3 mb-4",children:g.map(e=>(0,s.jsxs)(o.z,{type:"button",variant:(v.amount,"outline"),onClick:()=>D(e),className:`h-12 transition-all duration-200 ${v.amount===e?"bg-gradient-to-r from-indigo-600 to-cyan-600 text-white border-indigo-600 shadow-lg transform scale-105":"hover:bg-gray-50 hover:border-gray-400"}`,children:[e.toLocaleString()," VND"]},e))}),(0,s.jsxs)("div",{className:"relative",children:[s.jsx("span",{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-500",children:"VND"}),s.jsx(i.I,{type:"number",placeholder:"Custom amount",value:j,onChange:e=>C(e.target.value),className:"pl-12 h-12",min:"10000",step:"1000"})]})]}),(0,s.jsxs)("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Message (Optional)"}),s.jsx(i.I,{placeholder:"Leave a message for the streamer...",value:v.message,onChange:e=>b(t=>({...t,message:e.target.value})),className:"h-12"})]}),p.donationLink.allowAnonymous&&(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[s.jsx("input",{type:"checkbox",id:"anonymous",checked:v.isAnonymous,onChange:e=>b(t=>({...t,isAnonymous:e.target.checked})),className:"rounded border-gray-300 text-indigo-600 focus:ring-indigo-500"}),s.jsx("label",{htmlFor:"anonymous",className:"text-sm text-gray-700",children:"Make this donation anonymous"})]}),(0,s.jsxs)("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Payment Method"}),(0,s.jsxs)("select",{value:v.paymentMethod,onChange:e=>b(t=>({...t,paymentMethod:e.target.value})),className:"w-full h-12 px-4 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",children:[s.jsx("option",{value:"wallet",children:"Wallet Balance"}),s.jsx("option",{value:"bank_transfer",children:"Bank Transfer"}),s.jsx("option",{value:"stripe",children:"Credit/Debit Card"}),s.jsx("option",{value:"paypal",children:"PayPal"})]})]}),s.jsx(o.z,{type:"submit",disabled:w||v.amount<=0,className:"w-full h-12 bg-gradient-to-r from-indigo-600 to-cyan-600 hover:from-indigo-700 hover:to-cyan-700 text-white font-medium text-lg",children:w?(0,s.jsxs)(s.Fragment,{children:[s.jsx(d.T,{size:"sm"}),s.jsx("span",{className:"ml-2",children:"Processing..."})]}):(0,s.jsxs)(s.Fragment,{children:[s.jsx(x.Z,{className:"h-5 w-5 mr-2"}),"Donate ",v.amount.toLocaleString()," VND"]})})]})})]}),(0,s.jsxs)("div",{className:"mt-8 text-center text-gray-600",children:[(0,s.jsxs)("p",{className:"mb-4",children:["Your donation will be processed securely and ",p.name," will be notified immediately."]}),(0,s.jsxs)("p",{className:"text-sm",children:["Need help? Contact our support team or visit our"," ",s.jsx(o.z,{variant:"link",className:"p-0 h-auto text-indigo-600",children:"FAQ page"})]})]})]})}):null}},90368:(e,t,r)=>{"use strict";r.d(t,{Z:()=>o});var s=r(54714);r(77580);var a=r(31812),n=r(95773);function o({children:e}){let{sidebarOpen:t,toggleSidebar:r}=(0,a.HB)();return(0,s.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-indigo-50 via-white to-cyan-50",children:[s.jsx(n.Header,{}),s.jsx("main",{className:"relative",children:e})]})}},42708:(e,t,r)=>{"use strict";r.d(t,{T:()=>a});var s=r(54714);function a({size:e="md",className:t=""}){return s.jsx("div",{className:`flex justify-center items-center ${t}`,children:s.jsx("div",{className:`${{sm:"w-4 h-4",md:"w-8 h-8",lg:"w-12 h-12"}[e]} animate-spin rounded-full border-4 border-gray-200 border-t-blue-600`,role:"status","aria-label":"Loading"})})}},46475:(e,t,r)=>{"use strict";r.d(t,{z:()=>o});var s=r(54714),a=r(77580),n=r(35178);let o=a.forwardRef(({className:e,variant:t="default",size:r="default",...a},o)=>s.jsx("button",{className:(0,n.cn)("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"}[t],{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}[r],e),ref:o,...a}));o.displayName="Button"},83446:(e,t,r)=>{"use strict";r.d(t,{Ol:()=>i,SZ:()=>d,Zb:()=>o,aY:()=>c,ll:()=>l});var s=r(54714),a=r(77580),n=r(35178);let o=a.forwardRef(({className:e,...t},r)=>s.jsx("div",{ref:r,className:(0,n.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",e),...t}));o.displayName="Card";let i=a.forwardRef(({className:e,...t},r)=>s.jsx("div",{ref:r,className:(0,n.cn)("flex flex-col space-y-1.5 p-6",e),...t}));i.displayName="CardHeader";let l=a.forwardRef(({className:e,...t},r)=>s.jsx("h3",{ref:r,className:(0,n.cn)("text-2xl font-semibold leading-none tracking-tight",e),...t}));l.displayName="CardTitle";let d=a.forwardRef(({className:e,...t},r)=>s.jsx("p",{ref:r,className:(0,n.cn)("text-sm text-muted-foreground",e),...t}));d.displayName="CardDescription";let c=a.forwardRef(({className:e,...t},r)=>s.jsx("div",{ref:r,className:(0,n.cn)("p-6 pt-0",e),...t}));c.displayName="CardContent",a.forwardRef(({className:e,...t},r)=>s.jsx("div",{ref:r,className:(0,n.cn)("flex items-center p-6 pt-0",e),...t})).displayName="CardFooter"},27114:(e,t,r)=>{"use strict";r.d(t,{I:()=>o});var s=r(54714),a=r(77580),n=r(35178);let o=a.forwardRef(({className:e,type:t,...r},a)=>s.jsx("input",{type:t,className:(0,n.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",e),ref:a,...r}));o.displayName="Input"},35178:(e,t,r)=>{"use strict";r.d(t,{cn:()=>n,p6:()=>i,xG:()=>o});var s=r(54690),a=r(68184);function n(...e){return(0,a.m6)((0,s.W)(e))}function o(e,t){if(null==e||isNaN(e))return"0.00";let r="string"==typeof e?parseFloat(e):e;try{return new Intl.NumberFormat("en-US",{style:"currency",currency:t.toUpperCase(),minimumFractionDigits:2,maximumFractionDigits:2}).format(r)}catch(e){return`${t.toUpperCase()} ${r.toFixed(2)}`}}function i(e,t={}){try{let r=new Date(e);if(isNaN(r.getTime()))return"Invalid Date";let s={year:"numeric",month:"short",day:"numeric",...t};return r.toLocaleDateString("en-US",s)}catch(e){return"Invalid Date"}}},36834:(e,t,r)=>{"use strict";r.d(t,{Z:()=>u});var s=r(77580);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),n=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,r)=>r?r.toUpperCase():t.toLowerCase()),o=e=>{let t=n(e);return t.charAt(0).toUpperCase()+t.slice(1)},i=(...e)=>e.filter((e,t,r)=>!!e&&""!==e.trim()&&r.indexOf(e)===t).join(" ").trim(),l=e=>{for(let t in e)if(t.startsWith("aria-")||"role"===t||"title"===t)return!0};/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var d={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let c=(0,s.forwardRef)(({color:e="currentColor",size:t=24,strokeWidth:r=2,absoluteStrokeWidth:a,className:n="",children:o,iconNode:c,...u},m)=>(0,s.createElement)("svg",{ref:m,...d,width:t,height:t,stroke:e,strokeWidth:a?24*Number(r)/Number(t):r,className:i("lucide",n),...!o&&!l(u)&&{"aria-hidden":"true"},...u},[...c.map(([e,t])=>(0,s.createElement)(e,t)),...Array.isArray(o)?o:[o]])),u=(e,t)=>{let r=(0,s.forwardRef)(({className:r,...n},l)=>(0,s.createElement)(c,{ref:l,iconNode:t,className:i(`lucide-${a(o(e))}`,`lucide-${e}`,r),...n}));return r.displayName=o(e),r}},53278:(e,t,r)=>{"use strict";r.d(t,{Z:()=>s});let s=(0,r(36834).Z)("arrow-left",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},56825:(e,t,r)=>{"use strict";r.d(t,{Z:()=>s});let s=(0,r(36834).Z)("gift",[["rect",{x:"3",y:"8",width:"18",height:"4",rx:"1",key:"bkv52"}],["path",{d:"M12 8v13",key:"1c76mn"}],["path",{d:"M19 12v7a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2v-7",key:"6wjy6b"}],["path",{d:"M7.5 8a2.5 2.5 0 0 1 0-5A4.8 8 0 0 1 12 8a4.8 8 0 0 1 4.5-5 2.5 2.5 0 0 1 0 5",key:"1ihvrl"}]])},532:(e,t,r)=>{"use strict";r.r(t),r.d(t,{$$typeof:()=>o,__esModule:()=>n,default:()=>d,dynamic:()=>l});var s=r(71481);let a=(0,s.createProxy)(String.raw`D:\repo\xscan\frontend\src\app\donate\[slug]\page.tsx`),{__esModule:n,$$typeof:o}=a,i=a.default,l=(0,s.createProxy)(String.raw`D:\repo\xscan\frontend\src\app\donate\[slug]\page.tsx#dynamic`),d=i}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[3499,9003,5070,1934,1707,5773],()=>r(586));module.exports=s})();