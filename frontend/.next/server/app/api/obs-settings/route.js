"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/obs-settings/route";
exports.ids = ["app/api/obs-settings/route"];
exports.modules = {

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "(rsc)/../node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fobs-settings%2Froute&page=%2Fapi%2Fobs-settings%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fobs-settings%2Froute.ts&appDir=D%3A%5Crepo%5Cxscan%5Cfrontend%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=D%3A%5Crepo%5Cxscan%5Cfrontend&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=standalone&preferredRegion=&middlewareConfig=e30%3D!":
/*!*********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ../node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fobs-settings%2Froute&page=%2Fapi%2Fobs-settings%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fobs-settings%2Froute.ts&appDir=D%3A%5Crepo%5Cxscan%5Cfrontend%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=D%3A%5Crepo%5Cxscan%5Cfrontend&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=standalone&preferredRegion=&middlewareConfig=e30%3D! ***!
  \*********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   headerHooks: () => (/* binding */ headerHooks),\n/* harmony export */   originalPathname: () => (/* binding */ originalPathname),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   requestAsyncStorage: () => (/* binding */ requestAsyncStorage),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   staticGenerationAsyncStorage: () => (/* binding */ staticGenerationAsyncStorage),\n/* harmony export */   staticGenerationBailout: () => (/* binding */ staticGenerationBailout)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/app-route/module.compiled */ \"(rsc)/../node_modules/next/dist/server/future/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(rsc)/../node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/../node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var D_repo_xscan_frontend_src_app_api_obs_settings_route_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./src/app/api/obs-settings/route.ts */ \"(rsc)/./src/app/api/obs-settings/route.ts\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"standalone\"\nconst routeModule = new next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/obs-settings/route\",\n        pathname: \"/api/obs-settings\",\n        filename: \"route\",\n        bundlePath: \"app/api/obs-settings/route\"\n    },\n    resolvedPagePath: \"D:\\\\repo\\\\xscan\\\\frontend\\\\src\\\\app\\\\api\\\\obs-settings\\\\route.ts\",\n    nextConfigOutput,\n    userland: D_repo_xscan_frontend_src_app_api_obs_settings_route_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { requestAsyncStorage, staticGenerationAsyncStorage, serverHooks, headerHooks, staticGenerationBailout } = routeModule;\nconst originalPathname = \"/api/obs-settings/route\";\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        serverHooks,\n        staticGenerationAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi4vbm9kZV9tb2R1bGVzL25leHQvZGlzdC9idWlsZC93ZWJwYWNrL2xvYWRlcnMvbmV4dC1hcHAtbG9hZGVyLmpzP25hbWU9YXBwJTJGYXBpJTJGb2JzLXNldHRpbmdzJTJGcm91dGUmcGFnZT0lMkZhcGklMkZvYnMtc2V0dGluZ3MlMkZyb3V0ZSZhcHBQYXRocz0mcGFnZVBhdGg9cHJpdmF0ZS1uZXh0LWFwcC1kaXIlMkZhcGklMkZvYnMtc2V0dGluZ3MlMkZyb3V0ZS50cyZhcHBEaXI9RCUzQSU1Q3JlcG8lNUN4c2NhbiU1Q2Zyb250ZW5kJTVDc3JjJTVDYXBwJnBhZ2VFeHRlbnNpb25zPXRzeCZwYWdlRXh0ZW5zaW9ucz10cyZwYWdlRXh0ZW5zaW9ucz1qc3gmcGFnZUV4dGVuc2lvbnM9anMmcm9vdERpcj1EJTNBJTVDcmVwbyU1Q3hzY2FuJTVDZnJvbnRlbmQmaXNEZXY9dHJ1ZSZ0c2NvbmZpZ1BhdGg9dHNjb25maWcuanNvbiZiYXNlUGF0aD0mYXNzZXRQcmVmaXg9Jm5leHRDb25maWdPdXRwdXQ9c3RhbmRhbG9uZSZwcmVmZXJyZWRSZWdpb249Jm1pZGRsZXdhcmVDb25maWc9ZTMwJTNEISIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7OztBQUFzRztBQUN2QztBQUNjO0FBQ2dCO0FBQzdGO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QixnSEFBbUI7QUFDM0M7QUFDQSxjQUFjLHlFQUFTO0FBQ3ZCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxZQUFZO0FBQ1osQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBLFFBQVEsdUdBQXVHO0FBQy9HO0FBQ0E7QUFDQSxXQUFXLDRFQUFXO0FBQ3RCO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDNko7O0FBRTdKIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8veHNjYW4tZnJvbnRlbmQvPzkzN2YiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQXBwUm91dGVSb3V0ZU1vZHVsZSB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2Z1dHVyZS9yb3V0ZS1tb2R1bGVzL2FwcC1yb3V0ZS9tb2R1bGUuY29tcGlsZWRcIjtcbmltcG9ydCB7IFJvdXRlS2luZCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2Z1dHVyZS9yb3V0ZS1raW5kXCI7XG5pbXBvcnQgeyBwYXRjaEZldGNoIGFzIF9wYXRjaEZldGNoIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvbGliL3BhdGNoLWZldGNoXCI7XG5pbXBvcnQgKiBhcyB1c2VybGFuZCBmcm9tIFwiRDpcXFxccmVwb1xcXFx4c2NhblxcXFxmcm9udGVuZFxcXFxzcmNcXFxcYXBwXFxcXGFwaVxcXFxvYnMtc2V0dGluZ3NcXFxccm91dGUudHNcIjtcbi8vIFdlIGluamVjdCB0aGUgbmV4dENvbmZpZ091dHB1dCBoZXJlIHNvIHRoYXQgd2UgY2FuIHVzZSB0aGVtIGluIHRoZSByb3V0ZVxuLy8gbW9kdWxlLlxuY29uc3QgbmV4dENvbmZpZ091dHB1dCA9IFwic3RhbmRhbG9uZVwiXG5jb25zdCByb3V0ZU1vZHVsZSA9IG5ldyBBcHBSb3V0ZVJvdXRlTW9kdWxlKHtcbiAgICBkZWZpbml0aW9uOiB7XG4gICAgICAgIGtpbmQ6IFJvdXRlS2luZC5BUFBfUk9VVEUsXG4gICAgICAgIHBhZ2U6IFwiL2FwaS9vYnMtc2V0dGluZ3Mvcm91dGVcIixcbiAgICAgICAgcGF0aG5hbWU6IFwiL2FwaS9vYnMtc2V0dGluZ3NcIixcbiAgICAgICAgZmlsZW5hbWU6IFwicm91dGVcIixcbiAgICAgICAgYnVuZGxlUGF0aDogXCJhcHAvYXBpL29icy1zZXR0aW5ncy9yb3V0ZVwiXG4gICAgfSxcbiAgICByZXNvbHZlZFBhZ2VQYXRoOiBcIkQ6XFxcXHJlcG9cXFxceHNjYW5cXFxcZnJvbnRlbmRcXFxcc3JjXFxcXGFwcFxcXFxhcGlcXFxcb2JzLXNldHRpbmdzXFxcXHJvdXRlLnRzXCIsXG4gICAgbmV4dENvbmZpZ091dHB1dCxcbiAgICB1c2VybGFuZFxufSk7XG4vLyBQdWxsIG91dCB0aGUgZXhwb3J0cyB0aGF0IHdlIG5lZWQgdG8gZXhwb3NlIGZyb20gdGhlIG1vZHVsZS4gVGhpcyBzaG91bGRcbi8vIGJlIGVsaW1pbmF0ZWQgd2hlbiB3ZSd2ZSBtb3ZlZCB0aGUgb3RoZXIgcm91dGVzIHRvIHRoZSBuZXcgZm9ybWF0LiBUaGVzZVxuLy8gYXJlIHVzZWQgdG8gaG9vayBpbnRvIHRoZSByb3V0ZS5cbmNvbnN0IHsgcmVxdWVzdEFzeW5jU3RvcmFnZSwgc3RhdGljR2VuZXJhdGlvbkFzeW5jU3RvcmFnZSwgc2VydmVySG9va3MsIGhlYWRlckhvb2tzLCBzdGF0aWNHZW5lcmF0aW9uQmFpbG91dCB9ID0gcm91dGVNb2R1bGU7XG5jb25zdCBvcmlnaW5hbFBhdGhuYW1lID0gXCIvYXBpL29icy1zZXR0aW5ncy9yb3V0ZVwiO1xuZnVuY3Rpb24gcGF0Y2hGZXRjaCgpIHtcbiAgICByZXR1cm4gX3BhdGNoRmV0Y2goe1xuICAgICAgICBzZXJ2ZXJIb29rcyxcbiAgICAgICAgc3RhdGljR2VuZXJhdGlvbkFzeW5jU3RvcmFnZVxuICAgIH0pO1xufVxuZXhwb3J0IHsgcm91dGVNb2R1bGUsIHJlcXVlc3RBc3luY1N0b3JhZ2UsIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2UsIHNlcnZlckhvb2tzLCBoZWFkZXJIb29rcywgc3RhdGljR2VuZXJhdGlvbkJhaWxvdXQsIG9yaWdpbmFsUGF0aG5hbWUsIHBhdGNoRmV0Y2gsICB9O1xuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1hcHAtcm91dGUuanMubWFwIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/../node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fobs-settings%2Froute&page=%2Fapi%2Fobs-settings%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fobs-settings%2Froute.ts&appDir=D%3A%5Crepo%5Cxscan%5Cfrontend%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=D%3A%5Crepo%5Cxscan%5Cfrontend&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=standalone&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./src/app/api/obs-settings/route.ts":
/*!*******************************************!*\
  !*** ./src/app/api/obs-settings/route.ts ***!
  \*******************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   GET: () => (/* binding */ GET),\n/* harmony export */   PATCH: () => (/* binding */ PATCH),\n/* harmony export */   POST: () => (/* binding */ POST)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/web/exports/next-response */ \"(rsc)/../node_modules/next/dist/server/web/exports/next-response.js\");\n\n// Resolve backend URL safely to avoid self-calls (port 3000) in local dev\nconst resolveBackendUrl = ()=>{\n    const serverUrl = \"http://localhost:3001\";\n    const publicUrl = process.env.NEXT_PUBLIC_BACKEND_URL;\n    let url = serverUrl || publicUrl || \"http://localhost:3001\";\n    if (url.includes(\"localhost:3000\")) {\n        url = url.replace(\"localhost:3000\", \"localhost:3001\");\n    }\n    return url;\n};\nconst BACKEND_URL = resolveBackendUrl();\n// Custom body parser for handling large payloads\nasync function parseBody(request) {\n    try {\n        const contentType = request.headers.get(\"content-type\") || \"\";\n        // For large files, use streaming parser\n        if (contentType.includes(\"multipart/form-data\")) {\n            // Handle multipart form data (file uploads)\n            const formData = await request.formData();\n            const body = {};\n            // Convert FormData entries to array for iteration\n            const entries = Array.from(formData.entries());\n            for (const [key, value] of entries){\n                if (value instanceof File) {\n                    // For very large files, we might want to process in chunks\n                    // But for now, let's try to handle the full file\n                    try {\n                        const arrayBuffer = await value.arrayBuffer();\n                        const base64 = Buffer.from(arrayBuffer).toString(\"base64\");\n                        body[key] = {\n                            name: value.name,\n                            type: value.type,\n                            size: value.size,\n                            data: `data:${value.type};base64,${base64}`\n                        };\n                        console.log(`📁 Processed file: ${value.name}, size: ${value.size} bytes, encoded: ${base64.length} chars`);\n                    } catch (fileError) {\n                        console.error(`❌ Error processing file ${value.name}:`, fileError);\n                        throw new Error(`Failed to process file: ${value.name}`);\n                    }\n                } else {\n                    body[key] = value;\n                }\n            }\n            return body;\n        } else {\n            // Handle JSON payloads with size checking\n            const text = await request.text();\n            if (!text) return {};\n            console.log(`📝 Raw request body size: ${text.length} characters`);\n            // Check if the payload is too large\n            if (text.length > 50 * 1024 * 1024) {\n                throw new Error(\"Request payload exceeds 50MB limit\");\n            }\n            try {\n                return JSON.parse(text);\n            } catch (parseError) {\n                console.error(\"Failed to parse JSON body:\", parseError);\n                throw new Error(\"Invalid JSON payload\");\n            }\n        }\n    } catch (error) {\n        console.error(\"Error parsing request body:\", error);\n        throw error;\n    }\n}\nasync function GET(request) {\n    try {\n        // Get the authorization header\n        const authHeader = request.headers.get(\"authorization\");\n        if (!authHeader) {\n            return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n                error: \"Authorization header required\"\n            }, {\n                status: 401\n            });\n        }\n        console.log(\"\\uD83D\\uDD0D Fetching OBS settings for user...\");\n        console.log(\"\\uD83C\\uDF10 Backend URL:\", BACKEND_URL);\n        // Test backend connectivity first\n        try {\n            const healthCheck = await fetch(`${BACKEND_URL}/api/health`, {\n                method: \"GET\",\n                headers: {\n                    \"Content-Type\": \"application/json\"\n                }\n            });\n            console.log(\"\\uD83C\\uDFE5 Backend health check status:\", healthCheck.status);\n        } catch (error) {\n            console.error(\"❌ Backend connectivity test failed:\", error);\n            return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n                error: \"Backend service is not available. Please ensure the backend server is running on port 3001.\",\n                code: \"BACKEND_UNAVAILABLE\"\n            }, {\n                status: 503\n            });\n        }\n        // First, try to get existing OBS settings\n        const settingsUrl = `${BACKEND_URL}/api/obs-settings/my-settings`;\n        console.log(\"\\uD83D\\uDCE1 Making request to:\", settingsUrl);\n        let response = await fetch(settingsUrl, {\n            headers: {\n                \"Authorization\": authHeader,\n                \"Content-Type\": \"application/json\"\n            }\n        });\n        console.log(`📡 Backend response status: ${response.status}`);\n        console.log(`📡 Backend response statusText: ${response.statusText}`);\n        // If settings don't exist (404), create them with defaults\n        if (response.status === 404) {\n            console.log(\"⚠️ OBS settings not found, creating default settings...\");\n            // First, get the user's profile to get their id directly from backend\n            console.log(\"\\uD83D\\uDC64 Getting user profile from backend to get id...\");\n            const profileResponse = await fetch(`${BACKEND_URL}/api/auth/profile`, {\n                headers: {\n                    \"Authorization\": authHeader,\n                    \"Content-Type\": \"application/json\"\n                }\n            });\n            if (!profileResponse.ok) {\n                const errorData = await profileResponse.json();\n                console.error(\"❌ Failed to get user profile:\", errorData);\n                return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json(errorData, {\n                    status: profileResponse.status\n                });\n            }\n            const profileData = await profileResponse.json();\n            console.log(\"\\uD83D\\uDCE6 Raw profile response:\", profileData);\n            console.log(\"\\uD83D\\uDCE6 Profile response type:\", typeof profileData);\n            console.log(\"\\uD83D\\uDCE6 Profile response keys:\", Object.keys(profileData));\n            // Backend returns: { user: { id, ... } }\n            const userId = profileData?.user?.id;\n            console.log(\"\\uD83D\\uDC64 User ID for streamerId:\", userId);\n            console.log(\"\\uD83D\\uDD0D Available fields in profileData:\", Object.keys(profileData));\n            // Additional debugging to see the full structure\n            if (profileData.user) {\n                console.log(\"\\uD83D\\uDD0D Found nested user object:\", profileData.user);\n                console.log(\"\\uD83D\\uDD0D User object keys:\", Object.keys(profileData.user));\n                console.log(\"\\uD83D\\uDD0D User ID from nested object:\", profileData.user.id);\n            }\n            if (!userId) {\n                console.error(\"❌ Could not extract user ID from profile response\");\n                console.error(\"❌ Full profile response:\", JSON.stringify(profileData, null, 2));\n                return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n                    error: \"Could not determine user ID for OBS settings creation\",\n                    code: \"USER_ID_MISSING\"\n                }, {\n                    status: 400\n                });\n            }\n            // Create default OBS settings\n            const createResponse = await fetch(`${BACKEND_URL}/api/obs-settings`, {\n                method: \"POST\",\n                headers: {\n                    \"Authorization\": authHeader,\n                    \"Content-Type\": \"application/json\"\n                },\n                body: JSON.stringify({\n                    streamerId: userId,\n                    imageSettings: {\n                        enabled: true,\n                        mediaType: \"image\",\n                        width: 300,\n                        height: 200,\n                        borderRadius: 8,\n                        shadow: true,\n                        shadowColor: \"#000000\",\n                        shadowBlur: 10,\n                        shadowOffsetX: 2,\n                        shadowOffsetY: 2\n                    },\n                    soundSettings: {\n                        enabled: true,\n                        volume: 80,\n                        fadeIn: 0,\n                        fadeOut: 0,\n                        loop: false\n                    },\n                    animationSettings: {\n                        enabled: true,\n                        animationType: \"fade\",\n                        duration: 500,\n                        easing: \"ease-out\",\n                        direction: \"right\",\n                        bounceIntensity: 20,\n                        zoomScale: 1.2\n                    },\n                    styleSettings: {\n                        backgroundColor: \"#1a1a1a\",\n                        textColor: \"#ffffff\",\n                        accentColor: \"#00ff00\",\n                        borderColor: \"#333333\",\n                        borderWidth: 2,\n                        borderStyle: \"solid\",\n                        fontFamily: \"Arial, sans-serif\",\n                        fontSize: 16,\n                        fontWeight: \"normal\",\n                        fontStyle: \"normal\",\n                        textShadow: true,\n                        textShadowColor: \"#000000\",\n                        textShadowBlur: 3,\n                        textShadowOffsetX: 1,\n                        textShadowOffsetY: 1\n                    },\n                    positionSettings: {\n                        x: 100,\n                        y: 100,\n                        anchor: \"top-left\",\n                        zIndex: 1000,\n                        responsive: true,\n                        mobileScale: 0.8\n                    },\n                    displaySettings: {\n                        duration: 5000,\n                        fadeInDuration: 300,\n                        fadeOutDuration: 300,\n                        autoHide: true,\n                        showProgress: false,\n                        progressColor: \"#00ff00\",\n                        progressHeight: 3\n                    },\n                    generalSettings: {\n                        enabled: true,\n                        maxAlerts: 3,\n                        alertSpacing: 20,\n                        cooldown: 1000,\n                        priority: \"medium\"\n                    },\n                    isActive: true\n                })\n            });\n            console.log(`📝 Create settings response status: ${createResponse.status}`);\n            if (!createResponse.ok) {\n                const errorData = await createResponse.json();\n                console.error(\"❌ Failed to create OBS settings:\", errorData);\n                return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json(errorData, {\n                    status: createResponse.status\n                });\n            }\n            console.log(\"✅ OBS settings created successfully, fetching settings...\");\n            // Now try to get the settings again\n            response = await fetch(settingsUrl, {\n                headers: {\n                    \"Authorization\": authHeader,\n                    \"Content-Type\": \"application/json\"\n                }\n            });\n            console.log(`📡 Second attempt response status: ${response.status}`);\n        }\n        if (!response.ok) {\n            const errorData = await response.json();\n            console.error(\"❌ Error response from backend:\", errorData);\n            console.error(\"❌ Response status:\", response.status);\n            console.error(\"❌ Response statusText:\", response.statusText);\n            // Handle specific error cases\n            if (response.status === 403) {\n                return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n                    error: \"Access denied. OBS settings are only available for streamers and administrators.\",\n                    code: \"ACCESS_DENIED\"\n                }, {\n                    status: 403\n                });\n            }\n            return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json(errorData, {\n                status: response.status\n            });\n        }\n        const data = await response.json();\n        // Ensure widgetUrl is present for the frontend\n        if (data && data.streamerId && data.alertToken && !data.widgetUrl) {\n            data.widgetUrl = `${BACKEND_URL}/api/widget-public/alert/${data.streamerId}/${data.alertToken}`;\n        }\n        console.log(\"✅ Successfully retrieved OBS settings:\", data);\n        return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json(data);\n    } catch (error) {\n        console.error(\"\\uD83D\\uDCA5 Unexpected error in OBS settings API:\", error);\n        return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n            error: \"Failed to fetch OBS settings\"\n        }, {\n            status: 500\n        });\n    }\n}\nasync function POST(request) {\n    try {\n        // Get the authorization header\n        const authHeader = request.headers.get(\"authorization\");\n        if (!authHeader) {\n            return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n                error: \"Authorization header required\"\n            }, {\n                status: 401\n            });\n        }\n        // Get the request body\n        const body = await request.json();\n        // Create OBS settings\n        const response = await fetch(`${BACKEND_URL}/api/obs-settings`, {\n            method: \"POST\",\n            headers: {\n                \"Authorization\": authHeader,\n                \"Content-Type\": \"application/json\"\n            },\n            body: JSON.stringify(body)\n        });\n        if (!response.ok) {\n            const errorData = await response.json();\n            // Handle specific error cases\n            if (response.status === 403) {\n                return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n                    error: \"Access denied. OBS settings are only available for streamers and administrators.\",\n                    code: \"ACCESS_DENIED\"\n                }, {\n                    status: 403\n                });\n            }\n            return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json(errorData, {\n                status: response.status\n            });\n        }\n        const data = await response.json();\n        return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json(data, {\n            status: 201\n        });\n    } catch (error) {\n        console.error(\"Error creating OBS settings:\", error);\n        return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n            error: \"Failed to create OBS settings\"\n        }, {\n            status: 500\n        });\n    }\n}\nasync function PATCH(request) {\n    try {\n        console.log(\"\\uD83D\\uDE80 PATCH request received for OBS settings\");\n        // Get the authorization header\n        const authHeader = request.headers.get(\"authorization\");\n        if (!authHeader) {\n            return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n                error: \"Authorization header required\"\n            }, {\n                status: 401\n            });\n        }\n        // Log request details for debugging\n        const contentLength = request.headers.get(\"content-length\");\n        const contentType = request.headers.get(\"content-type\");\n        console.log(\"\\uD83D\\uDCDD Request content-length header:\", contentLength);\n        console.log(\"\\uD83D\\uDCDD Request content-type:\", contentType);\n        console.log(\"\\uD83D\\uDCDD Request method:\", request.method);\n        console.log(\"\\uD83D\\uDCDD Request URL:\", request.url);\n        // Use custom body parser for large payloads\n        console.log(\"\\uD83D\\uDD04 Starting to parse request body...\");\n        const body = await parseBody(request);\n        console.log(\"\\uD83D\\uDCDD Parsed request body size:\", JSON.stringify(body).length, \"characters\");\n        console.log(\"\\uD83D\\uDCDD Body keys:\", Object.keys(body));\n        // Check if body is too large for backend\n        const bodySize = JSON.stringify(body).length;\n        if (bodySize > 50 * 1024 * 1024) {\n            console.warn(\"⚠️ Body size exceeds 50MB, may cause backend issues\");\n        }\n        // Update OBS settings\n        const response = await fetch(`${BACKEND_URL}/api/obs-settings/my-settings`, {\n            method: \"PATCH\",\n            headers: {\n                \"Authorization\": authHeader,\n                \"Content-Type\": \"application/json\"\n            },\n            body: JSON.stringify(body)\n        });\n        if (!response.ok) {\n            const errorData = await response.json();\n            console.error(\"❌ Backend response error:\", response.status, errorData);\n            // Handle specific error cases\n            if (response.status === 403) {\n                return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n                    error: \"Access denied. OBS settings are only available for streamers and administrators.\",\n                    code: \"ACCESS_DENIED\"\n                }, {\n                    status: 403\n                });\n            }\n            if (response.status === 404) {\n                return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n                    error: \"OBS settings not found. Please create settings first.\",\n                    code: \"SETTINGS_NOT_FOUND\"\n                }, {\n                    status: 404\n                });\n            }\n            return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json(errorData, {\n                status: response.status\n            });\n        }\n        const data = await response.json();\n        console.log(\"✅ Backend update successful\");\n        return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json(data, {\n            status: 200\n        });\n    } catch (error) {\n        console.error(\"Error updating OBS settings:\", error);\n        // Handle specific parsing errors\n        if (error instanceof Error && error.message.includes(\"Failed to parse request body\")) {\n            return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n                error: \"Request payload is too large or invalid. Please ensure files are under 50MB.\",\n                code: \"PAYLOAD_TOO_LARGE\"\n            }, {\n                status: 413\n            });\n        }\n        return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n            error: \"Failed to update OBS settings\"\n        }, {\n            status: 500\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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VTtZQUU1RCw4QkFBOEI7WUFDOUIsSUFBSUosU0FBU04sTUFBTSxLQUFLLEtBQUs7Z0JBQzNCLE9BQU83QyxrRkFBWUEsQ0FBQzRDLElBQUksQ0FBQztvQkFDdkJSLE9BQU87b0JBQ1BhLE1BQU07Z0JBQ1IsR0FBRztvQkFBRUosUUFBUTtnQkFBSTtZQUNuQjtZQUVBLElBQUlNLFNBQVNOLE1BQU0sS0FBSyxLQUFLO2dCQUMzQixPQUFPN0Msa0ZBQVlBLENBQUM0QyxJQUFJLENBQUM7b0JBQ3ZCUixPQUFPO29CQUNQYSxNQUFNO2dCQUNSLEdBQUc7b0JBQUVKLFFBQVE7Z0JBQUk7WUFDbkI7WUFFQSxPQUFPN0Msa0ZBQVlBLENBQUM0QyxJQUFJLENBQUNXLFdBQVc7Z0JBQUVWLFFBQVFNLFNBQVNOLE1BQU07WUFBQztRQUNoRTtRQUVBLE1BQU1kLE9BQU8sTUFBTW9CLFNBQVNQLElBQUk7UUFDaENaLFFBQVFDLEdBQUcsQ0FBQztRQUNaLE9BQU9qQyxrRkFBWUEsQ0FBQzRDLElBQUksQ0FBQ2IsTUFBTTtZQUFFYyxRQUFRO1FBQUk7SUFDL0MsRUFBRSxPQUFPVCxPQUFPO1FBQ2RKLFFBQVFJLEtBQUssQ0FBQyxnQ0FBZ0NBO1FBRTlDLGlDQUFpQztRQUNqQyxJQUFJQSxpQkFBaUJDLFNBQVNELE1BQU0rRixPQUFPLENBQUMxSCxRQUFRLENBQUMsaUNBQWlDO1lBQ3BGLE9BQU9ULGtGQUFZQSxDQUFDNEMsSUFBSSxDQUFDO2dCQUN2QlIsT0FBTztnQkFDUGEsTUFBTTtZQUNSLEdBQUc7Z0JBQUVKLFFBQVE7WUFBSTtRQUNuQjtRQUVBLE9BQU83QyxrRkFBWUEsQ0FBQzRDLElBQUksQ0FDdEI7WUFBRVIsT0FBTztRQUFnQyxHQUN6QztZQUFFUyxRQUFRO1FBQUk7SUFFbEI7QUFDRiIsInNvdXJjZXMiOlsid2VicGFjazovL3hzY2FuLWZyb250ZW5kLy4vc3JjL2FwcC9hcGkvb2JzLXNldHRpbmdzL3JvdXRlLnRzPzZjNGIiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgTmV4dFJlcXVlc3QsIE5leHRSZXNwb25zZSB9IGZyb20gJ25leHQvc2VydmVyJztcblxuLy8gUmVzb2x2ZSBiYWNrZW5kIFVSTCBzYWZlbHkgdG8gYXZvaWQgc2VsZi1jYWxscyAocG9ydCAzMDAwKSBpbiBsb2NhbCBkZXZcbmNvbnN0IHJlc29sdmVCYWNrZW5kVXJsID0gKCk6IHN0cmluZyA9PiB7XG4gIGNvbnN0IHNlcnZlclVybCA9IHByb2Nlc3MuZW52LkJBQ0tFTkRfVVJMO1xuICBjb25zdCBwdWJsaWNVcmwgPSBwcm9jZXNzLmVudi5ORVhUX1BVQkxJQ19CQUNLRU5EX1VSTDtcbiAgbGV0IHVybCA9IHNlcnZlclVybCB8fCBwdWJsaWNVcmwgfHwgJ2h0dHA6Ly9sb2NhbGhvc3Q6MzAwMSc7XG4gIGlmICh1cmwuaW5jbHVkZXMoJ2xvY2FsaG9zdDozMDAwJykpIHtcbiAgICB1cmwgPSB1cmwucmVwbGFjZSgnbG9jYWxob3N0OjMwMDAnLCAnbG9jYWxob3N0OjMwMDEnKTtcbiAgfVxuICByZXR1cm4gdXJsO1xufTtcblxuY29uc3QgQkFDS0VORF9VUkwgPSByZXNvbHZlQmFja2VuZFVybCgpO1xuXG4vLyBDdXN0b20gYm9keSBwYXJzZXIgZm9yIGhhbmRsaW5nIGxhcmdlIHBheWxvYWRzXG5hc3luYyBmdW5jdGlvbiBwYXJzZUJvZHkocmVxdWVzdDogTmV4dFJlcXVlc3QpOiBQcm9taXNlPGFueT4ge1xuICB0cnkge1xuICAgIGNvbnN0IGNvbnRlbnRUeXBlID0gcmVxdWVzdC5oZWFkZXJzLmdldCgnY29udGVudC10eXBlJykgfHwgJyc7XG4gICAgXG4gICAgLy8gRm9yIGxhcmdlIGZpbGVzLCB1c2Ugc3RyZWFtaW5nIHBhcnNlclxuICAgIGlmIChjb250ZW50VHlwZS5pbmNsdWRlcygnbXVsdGlwYXJ0L2Zvcm0tZGF0YScpKSB7XG4gICAgICAvLyBIYW5kbGUgbXVsdGlwYXJ0IGZvcm0gZGF0YSAoZmlsZSB1cGxvYWRzKVxuICAgICAgY29uc3QgZm9ybURhdGEgPSBhd2FpdCByZXF1ZXN0LmZvcm1EYXRhKCk7XG4gICAgICBjb25zdCBib2R5OiBhbnkgPSB7fTtcbiAgICAgIFxuICAgICAgLy8gQ29udmVydCBGb3JtRGF0YSBlbnRyaWVzIHRvIGFycmF5IGZvciBpdGVyYXRpb25cbiAgICAgIGNvbnN0IGVudHJpZXMgPSBBcnJheS5mcm9tKGZvcm1EYXRhLmVudHJpZXMoKSk7XG4gICAgICBcbiAgICAgIGZvciAoY29uc3QgW2tleSwgdmFsdWVdIG9mIGVudHJpZXMpIHtcbiAgICAgICAgaWYgKHZhbHVlIGluc3RhbmNlb2YgRmlsZSkge1xuICAgICAgICAgIC8vIEZvciB2ZXJ5IGxhcmdlIGZpbGVzLCB3ZSBtaWdodCB3YW50IHRvIHByb2Nlc3MgaW4gY2h1bmtzXG4gICAgICAgICAgLy8gQnV0IGZvciBub3csIGxldCdzIHRyeSB0byBoYW5kbGUgdGhlIGZ1bGwgZmlsZVxuICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICBjb25zdCBhcnJheUJ1ZmZlciA9IGF3YWl0IHZhbHVlLmFycmF5QnVmZmVyKCk7XG4gICAgICAgICAgICBjb25zdCBiYXNlNjQgPSBCdWZmZXIuZnJvbShhcnJheUJ1ZmZlcikudG9TdHJpbmcoJ2Jhc2U2NCcpO1xuICAgICAgICAgICAgYm9keVtrZXldID0ge1xuICAgICAgICAgICAgICBuYW1lOiB2YWx1ZS5uYW1lLFxuICAgICAgICAgICAgICB0eXBlOiB2YWx1ZS50eXBlLFxuICAgICAgICAgICAgICBzaXplOiB2YWx1ZS5zaXplLFxuICAgICAgICAgICAgICBkYXRhOiBgZGF0YToke3ZhbHVlLnR5cGV9O2Jhc2U2NCwke2Jhc2U2NH1gXG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgY29uc29sZS5sb2coYPCfk4EgUHJvY2Vzc2VkIGZpbGU6ICR7dmFsdWUubmFtZX0sIHNpemU6ICR7dmFsdWUuc2l6ZX0gYnl0ZXMsIGVuY29kZWQ6ICR7YmFzZTY0Lmxlbmd0aH0gY2hhcnNgKTtcbiAgICAgICAgICB9IGNhdGNoIChmaWxlRXJyb3IpIHtcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoYOKdjCBFcnJvciBwcm9jZXNzaW5nIGZpbGUgJHt2YWx1ZS5uYW1lfTpgLCBmaWxlRXJyb3IpO1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBGYWlsZWQgdG8gcHJvY2VzcyBmaWxlOiAke3ZhbHVlLm5hbWV9YCk7XG4gICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGJvZHlba2V5XSA9IHZhbHVlO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBcbiAgICAgIHJldHVybiBib2R5O1xuICAgIH0gZWxzZSB7XG4gICAgICAvLyBIYW5kbGUgSlNPTiBwYXlsb2FkcyB3aXRoIHNpemUgY2hlY2tpbmdcbiAgICAgIGNvbnN0IHRleHQgPSBhd2FpdCByZXF1ZXN0LnRleHQoKTtcbiAgICAgIGlmICghdGV4dCkgcmV0dXJuIHt9O1xuICAgICAgXG4gICAgICBjb25zb2xlLmxvZyhg8J+TnSBSYXcgcmVxdWVzdCBib2R5IHNpemU6ICR7dGV4dC5sZW5ndGh9IGNoYXJhY3RlcnNgKTtcbiAgICAgIFxuICAgICAgLy8gQ2hlY2sgaWYgdGhlIHBheWxvYWQgaXMgdG9vIGxhcmdlXG4gICAgICBpZiAodGV4dC5sZW5ndGggPiA1MCAqIDEwMjQgKiAxMDI0KSB7IC8vIDUwTUIgbGltaXRcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdSZXF1ZXN0IHBheWxvYWQgZXhjZWVkcyA1ME1CIGxpbWl0Jyk7XG4gICAgICB9XG4gICAgICBcbiAgICAgIHRyeSB7XG4gICAgICAgIHJldHVybiBKU09OLnBhcnNlKHRleHQpO1xuICAgICAgfSBjYXRjaCAocGFyc2VFcnJvcikge1xuICAgICAgICBjb25zb2xlLmVycm9yKCdGYWlsZWQgdG8gcGFyc2UgSlNPTiBib2R5OicsIHBhcnNlRXJyb3IpO1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0ludmFsaWQgSlNPTiBwYXlsb2FkJyk7XG4gICAgICB9XG4gICAgfVxuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIHBhcnNpbmcgcmVxdWVzdCBib2R5OicsIGVycm9yKTtcbiAgICB0aHJvdyBlcnJvcjtcbiAgfVxufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gR0VUKHJlcXVlc3Q6IE5leHRSZXF1ZXN0KSB7XG4gIHRyeSB7XG4gICAgLy8gR2V0IHRoZSBhdXRob3JpemF0aW9uIGhlYWRlclxuICAgIGNvbnN0IGF1dGhIZWFkZXIgPSByZXF1ZXN0LmhlYWRlcnMuZ2V0KCdhdXRob3JpemF0aW9uJyk7XG4gICAgXG4gICAgaWYgKCFhdXRoSGVhZGVyKSB7XG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBlcnJvcjogJ0F1dGhvcml6YXRpb24gaGVhZGVyIHJlcXVpcmVkJyB9LCB7IHN0YXR1czogNDAxIH0pO1xuICAgIH1cblxuICAgIGNvbnNvbGUubG9nKCfwn5SNIEZldGNoaW5nIE9CUyBzZXR0aW5ncyBmb3IgdXNlci4uLicpO1xuICAgIGNvbnNvbGUubG9nKCfwn4yQIEJhY2tlbmQgVVJMOicsIEJBQ0tFTkRfVVJMKTtcblxuICAgIC8vIFRlc3QgYmFja2VuZCBjb25uZWN0aXZpdHkgZmlyc3RcbiAgICB0cnkge1xuICAgICAgY29uc3QgaGVhbHRoQ2hlY2sgPSBhd2FpdCBmZXRjaChgJHtCQUNLRU5EX1VSTH0vYXBpL2hlYWx0aGAsIHsgXG4gICAgICAgIG1ldGhvZDogJ0dFVCcsXG4gICAgICAgIGhlYWRlcnM6IHsgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyB9XG4gICAgICB9KTtcbiAgICAgIGNvbnNvbGUubG9nKCfwn4+lIEJhY2tlbmQgaGVhbHRoIGNoZWNrIHN0YXR1czonLCBoZWFsdGhDaGVjay5zdGF0dXMpO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCfinYwgQmFja2VuZCBjb25uZWN0aXZpdHkgdGVzdCBmYWlsZWQ6JywgZXJyb3IpO1xuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgXG4gICAgICAgIGVycm9yOiAnQmFja2VuZCBzZXJ2aWNlIGlzIG5vdCBhdmFpbGFibGUuIFBsZWFzZSBlbnN1cmUgdGhlIGJhY2tlbmQgc2VydmVyIGlzIHJ1bm5pbmcgb24gcG9ydCAzMDAxLicsXG4gICAgICAgIGNvZGU6ICdCQUNLRU5EX1VOQVZBSUxBQkxFJ1xuICAgICAgfSwgeyBzdGF0dXM6IDUwMyB9KTtcbiAgICB9XG5cbiAgICAvLyBGaXJzdCwgdHJ5IHRvIGdldCBleGlzdGluZyBPQlMgc2V0dGluZ3NcbiAgICBjb25zdCBzZXR0aW5nc1VybCA9IGAke0JBQ0tFTkRfVVJMfS9hcGkvb2JzLXNldHRpbmdzL215LXNldHRpbmdzYDtcbiAgICBjb25zb2xlLmxvZygn8J+ToSBNYWtpbmcgcmVxdWVzdCB0bzonLCBzZXR0aW5nc1VybCk7XG4gICAgXG4gICAgbGV0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2goc2V0dGluZ3NVcmwsIHtcbiAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgJ0F1dGhvcml6YXRpb24nOiBhdXRoSGVhZGVyLFxuICAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nLFxuICAgICAgfSxcbiAgICB9KTtcblxuICAgIGNvbnNvbGUubG9nKGDwn5OhIEJhY2tlbmQgcmVzcG9uc2Ugc3RhdHVzOiAke3Jlc3BvbnNlLnN0YXR1c31gKTtcbiAgICBjb25zb2xlLmxvZyhg8J+ToSBCYWNrZW5kIHJlc3BvbnNlIHN0YXR1c1RleHQ6ICR7cmVzcG9uc2Uuc3RhdHVzVGV4dH1gKTtcblxuICAgIC8vIElmIHNldHRpbmdzIGRvbid0IGV4aXN0ICg0MDQpLCBjcmVhdGUgdGhlbSB3aXRoIGRlZmF1bHRzXG4gICAgaWYgKHJlc3BvbnNlLnN0YXR1cyA9PT0gNDA0KSB7XG4gICAgICBjb25zb2xlLmxvZygn4pqg77iPIE9CUyBzZXR0aW5ncyBub3QgZm91bmQsIGNyZWF0aW5nIGRlZmF1bHQgc2V0dGluZ3MuLi4nKTtcbiAgICAgIFxuICAgICAgLy8gRmlyc3QsIGdldCB0aGUgdXNlcidzIHByb2ZpbGUgdG8gZ2V0IHRoZWlyIGlkIGRpcmVjdGx5IGZyb20gYmFja2VuZFxuICAgICAgY29uc29sZS5sb2coJ/CfkaQgR2V0dGluZyB1c2VyIHByb2ZpbGUgZnJvbSBiYWNrZW5kIHRvIGdldCBpZC4uLicpO1xuICAgICAgY29uc3QgcHJvZmlsZVJlc3BvbnNlID0gYXdhaXQgZmV0Y2goYCR7QkFDS0VORF9VUkx9L2FwaS9hdXRoL3Byb2ZpbGVgLCB7XG4gICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICAnQXV0aG9yaXphdGlvbic6IGF1dGhIZWFkZXIsXG4gICAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyxcbiAgICAgICAgfSxcbiAgICAgIH0pO1xuXG4gICAgICBpZiAoIXByb2ZpbGVSZXNwb25zZS5vaykge1xuICAgICAgICBjb25zdCBlcnJvckRhdGEgPSBhd2FpdCBwcm9maWxlUmVzcG9uc2UuanNvbigpO1xuICAgICAgICBjb25zb2xlLmVycm9yKCfinYwgRmFpbGVkIHRvIGdldCB1c2VyIHByb2ZpbGU6JywgZXJyb3JEYXRhKTtcbiAgICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKGVycm9yRGF0YSwgeyBzdGF0dXM6IHByb2ZpbGVSZXNwb25zZS5zdGF0dXMgfSk7XG4gICAgICB9XG5cbiAgICAgIGNvbnN0IHByb2ZpbGVEYXRhID0gYXdhaXQgcHJvZmlsZVJlc3BvbnNlLmpzb24oKTtcbiAgICAgIGNvbnNvbGUubG9nKCfwn5OmIFJhdyBwcm9maWxlIHJlc3BvbnNlOicsIHByb2ZpbGVEYXRhKTtcbiAgICAgIGNvbnNvbGUubG9nKCfwn5OmIFByb2ZpbGUgcmVzcG9uc2UgdHlwZTonLCB0eXBlb2YgcHJvZmlsZURhdGEpO1xuICAgICAgY29uc29sZS5sb2coJ/Cfk6YgUHJvZmlsZSByZXNwb25zZSBrZXlzOicsIE9iamVjdC5rZXlzKHByb2ZpbGVEYXRhKSk7XG4gICAgICBcbiAgICAgIC8vIEJhY2tlbmQgcmV0dXJuczogeyB1c2VyOiB7IGlkLCAuLi4gfSB9XG4gICAgICBjb25zdCB1c2VySWQgPSBwcm9maWxlRGF0YT8udXNlcj8uaWQ7XG4gICAgICBjb25zb2xlLmxvZygn8J+RpCBVc2VyIElEIGZvciBzdHJlYW1lcklkOicsIHVzZXJJZCk7XG4gICAgICBjb25zb2xlLmxvZygn8J+UjSBBdmFpbGFibGUgZmllbGRzIGluIHByb2ZpbGVEYXRhOicsIE9iamVjdC5rZXlzKHByb2ZpbGVEYXRhKSk7XG4gICAgICBcbiAgICAgIC8vIEFkZGl0aW9uYWwgZGVidWdnaW5nIHRvIHNlZSB0aGUgZnVsbCBzdHJ1Y3R1cmVcbiAgICAgIGlmIChwcm9maWxlRGF0YS51c2VyKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKCfwn5SNIEZvdW5kIG5lc3RlZCB1c2VyIG9iamVjdDonLCBwcm9maWxlRGF0YS51c2VyKTtcbiAgICAgICAgY29uc29sZS5sb2coJ/CflI0gVXNlciBvYmplY3Qga2V5czonLCBPYmplY3Qua2V5cyhwcm9maWxlRGF0YS51c2VyKSk7XG4gICAgICAgIGNvbnNvbGUubG9nKCfwn5SNIFVzZXIgSUQgZnJvbSBuZXN0ZWQgb2JqZWN0OicsIHByb2ZpbGVEYXRhLnVzZXIuaWQpO1xuICAgICAgfVxuICAgICAgXG4gICAgICBpZiAoIXVzZXJJZCkge1xuICAgICAgICBjb25zb2xlLmVycm9yKCfinYwgQ291bGQgbm90IGV4dHJhY3QgdXNlciBJRCBmcm9tIHByb2ZpbGUgcmVzcG9uc2UnKTtcbiAgICAgICAgY29uc29sZS5lcnJvcign4p2MIEZ1bGwgcHJvZmlsZSByZXNwb25zZTonLCBKU09OLnN0cmluZ2lmeShwcm9maWxlRGF0YSwgbnVsbCwgMikpO1xuICAgICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBcbiAgICAgICAgICBlcnJvcjogJ0NvdWxkIG5vdCBkZXRlcm1pbmUgdXNlciBJRCBmb3IgT0JTIHNldHRpbmdzIGNyZWF0aW9uJyxcbiAgICAgICAgICBjb2RlOiAnVVNFUl9JRF9NSVNTSU5HJ1xuICAgICAgICB9LCB7IHN0YXR1czogNDAwIH0pO1xuICAgICAgfVxuICAgICAgXG4gICAgICAvLyBDcmVhdGUgZGVmYXVsdCBPQlMgc2V0dGluZ3NcbiAgICAgIGNvbnN0IGNyZWF0ZVJlc3BvbnNlID0gYXdhaXQgZmV0Y2goYCR7QkFDS0VORF9VUkx9L2FwaS9vYnMtc2V0dGluZ3NgLCB7XG4gICAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgICBoZWFkZXJzOiB7XG4gICAgICAgICAgJ0F1dGhvcml6YXRpb24nOiBhdXRoSGVhZGVyLFxuICAgICAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicsXG4gICAgICAgIH0sXG4gICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgICBzdHJlYW1lcklkOiB1c2VySWQsIC8vIEluY2x1ZGUgdGhlIHVzZXIncyBfaWQgYXMgc3RyZWFtZXJJZFxuICAgICAgICAgIGltYWdlU2V0dGluZ3M6IHtcbiAgICAgICAgICAgIGVuYWJsZWQ6IHRydWUsXG4gICAgICAgICAgICBtZWRpYVR5cGU6ICdpbWFnZScsXG4gICAgICAgICAgICB3aWR0aDogMzAwLFxuICAgICAgICAgICAgaGVpZ2h0OiAyMDAsXG4gICAgICAgICAgICBib3JkZXJSYWRpdXM6IDgsXG4gICAgICAgICAgICBzaGFkb3c6IHRydWUsXG4gICAgICAgICAgICBzaGFkb3dDb2xvcjogJyMwMDAwMDAnLFxuICAgICAgICAgICAgc2hhZG93Qmx1cjogMTAsXG4gICAgICAgICAgICBzaGFkb3dPZmZzZXRYOiAyLFxuICAgICAgICAgICAgc2hhZG93T2Zmc2V0WTogMixcbiAgICAgICAgICB9LFxuICAgICAgICAgIHNvdW5kU2V0dGluZ3M6IHtcbiAgICAgICAgICAgIGVuYWJsZWQ6IHRydWUsXG4gICAgICAgICAgICB2b2x1bWU6IDgwLFxuICAgICAgICAgICAgZmFkZUluOiAwLFxuICAgICAgICAgICAgZmFkZU91dDogMCxcbiAgICAgICAgICAgIGxvb3A6IGZhbHNlLFxuICAgICAgICAgIH0sXG4gICAgICAgICAgYW5pbWF0aW9uU2V0dGluZ3M6IHtcbiAgICAgICAgICAgIGVuYWJsZWQ6IHRydWUsXG4gICAgICAgICAgICBhbmltYXRpb25UeXBlOiAnZmFkZScsXG4gICAgICAgICAgICBkdXJhdGlvbjogNTAwLFxuICAgICAgICAgICAgZWFzaW5nOiAnZWFzZS1vdXQnLFxuICAgICAgICAgICAgZGlyZWN0aW9uOiAncmlnaHQnLFxuICAgICAgICAgICAgYm91bmNlSW50ZW5zaXR5OiAyMCxcbiAgICAgICAgICAgIHpvb21TY2FsZTogMS4yLFxuICAgICAgICAgIH0sXG4gICAgICAgICAgc3R5bGVTZXR0aW5nczoge1xuICAgICAgICAgICAgYmFja2dyb3VuZENvbG9yOiAnIzFhMWExYScsXG4gICAgICAgICAgICB0ZXh0Q29sb3I6ICcjZmZmZmZmJyxcbiAgICAgICAgICAgIGFjY2VudENvbG9yOiAnIzAwZmYwMCcsXG4gICAgICAgICAgICBib3JkZXJDb2xvcjogJyMzMzMzMzMnLFxuICAgICAgICAgICAgYm9yZGVyV2lkdGg6IDIsXG4gICAgICAgICAgICBib3JkZXJTdHlsZTogJ3NvbGlkJyxcbiAgICAgICAgICAgIGZvbnRGYW1pbHk6ICdBcmlhbCwgc2Fucy1zZXJpZicsXG4gICAgICAgICAgICBmb250U2l6ZTogMTYsXG4gICAgICAgICAgICBmb250V2VpZ2h0OiAnbm9ybWFsJyxcbiAgICAgICAgICAgIGZvbnRTdHlsZTogJ25vcm1hbCcsXG4gICAgICAgICAgICB0ZXh0U2hhZG93OiB0cnVlLFxuICAgICAgICAgICAgdGV4dFNoYWRvd0NvbG9yOiAnIzAwMDAwMCcsXG4gICAgICAgICAgICB0ZXh0U2hhZG93Qmx1cjogMyxcbiAgICAgICAgICAgIHRleHRTaGFkb3dPZmZzZXRYOiAxLFxuICAgICAgICAgICAgdGV4dFNoYWRvd09mZnNldFk6IDEsXG4gICAgICAgICAgfSxcbiAgICAgICAgICBwb3NpdGlvblNldHRpbmdzOiB7XG4gICAgICAgICAgICB4OiAxMDAsXG4gICAgICAgICAgICB5OiAxMDAsXG4gICAgICAgICAgICBhbmNob3I6ICd0b3AtbGVmdCcsXG4gICAgICAgICAgICB6SW5kZXg6IDEwMDAsXG4gICAgICAgICAgICByZXNwb25zaXZlOiB0cnVlLFxuICAgICAgICAgICAgbW9iaWxlU2NhbGU6IDAuOCxcbiAgICAgICAgICB9LFxuICAgICAgICAgIGRpc3BsYXlTZXR0aW5nczoge1xuICAgICAgICAgICAgZHVyYXRpb246IDUwMDAsXG4gICAgICAgICAgICBmYWRlSW5EdXJhdGlvbjogMzAwLFxuICAgICAgICAgICAgZmFkZU91dER1cmF0aW9uOiAzMDAsXG4gICAgICAgICAgICBhdXRvSGlkZTogdHJ1ZSxcbiAgICAgICAgICAgIHNob3dQcm9ncmVzczogZmFsc2UsXG4gICAgICAgICAgICBwcm9ncmVzc0NvbG9yOiAnIzAwZmYwMCcsXG4gICAgICAgICAgICBwcm9ncmVzc0hlaWdodDogMyxcbiAgICAgICAgICB9LFxuICAgICAgICAgIGdlbmVyYWxTZXR0aW5nczoge1xuICAgICAgICAgICAgZW5hYmxlZDogdHJ1ZSxcbiAgICAgICAgICAgIG1heEFsZXJ0czogMyxcbiAgICAgICAgICAgIGFsZXJ0U3BhY2luZzogMjAsXG4gICAgICAgICAgICBjb29sZG93bjogMTAwMCxcbiAgICAgICAgICAgIHByaW9yaXR5OiAnbWVkaXVtJyxcbiAgICAgICAgICB9LFxuICAgICAgICAgIGlzQWN0aXZlOiB0cnVlLFxuICAgICAgICB9KSxcbiAgICAgIH0pO1xuXG4gICAgICBjb25zb2xlLmxvZyhg8J+TnSBDcmVhdGUgc2V0dGluZ3MgcmVzcG9uc2Ugc3RhdHVzOiAke2NyZWF0ZVJlc3BvbnNlLnN0YXR1c31gKTtcblxuICAgICAgaWYgKCFjcmVhdGVSZXNwb25zZS5vaykge1xuICAgICAgICBjb25zdCBlcnJvckRhdGEgPSBhd2FpdCBjcmVhdGVSZXNwb25zZS5qc29uKCk7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ+KdjCBGYWlsZWQgdG8gY3JlYXRlIE9CUyBzZXR0aW5nczonLCBlcnJvckRhdGEpO1xuICAgICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oZXJyb3JEYXRhLCB7IHN0YXR1czogY3JlYXRlUmVzcG9uc2Uuc3RhdHVzIH0pO1xuICAgICAgfVxuXG4gICAgICBjb25zb2xlLmxvZygn4pyFIE9CUyBzZXR0aW5ncyBjcmVhdGVkIHN1Y2Nlc3NmdWxseSwgZmV0Y2hpbmcgc2V0dGluZ3MuLi4nKTtcblxuICAgICAgLy8gTm93IHRyeSB0byBnZXQgdGhlIHNldHRpbmdzIGFnYWluXG4gICAgICByZXNwb25zZSA9IGF3YWl0IGZldGNoKHNldHRpbmdzVXJsLCB7XG4gICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICAnQXV0aG9yaXphdGlvbic6IGF1dGhIZWFkZXIsXG4gICAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyxcbiAgICAgICAgfSxcbiAgICAgIH0pO1xuXG4gICAgICBjb25zb2xlLmxvZyhg8J+ToSBTZWNvbmQgYXR0ZW1wdCByZXNwb25zZSBzdGF0dXM6ICR7cmVzcG9uc2Uuc3RhdHVzfWApO1xuICAgIH1cblxuICAgIGlmICghcmVzcG9uc2Uub2spIHtcbiAgICAgIGNvbnN0IGVycm9yRGF0YSA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKTtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ+KdjCBFcnJvciByZXNwb25zZSBmcm9tIGJhY2tlbmQ6JywgZXJyb3JEYXRhKTtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ+KdjCBSZXNwb25zZSBzdGF0dXM6JywgcmVzcG9uc2Uuc3RhdHVzKTtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ+KdjCBSZXNwb25zZSBzdGF0dXNUZXh0OicsIHJlc3BvbnNlLnN0YXR1c1RleHQpO1xuICAgICAgXG4gICAgICAvLyBIYW5kbGUgc3BlY2lmaWMgZXJyb3IgY2FzZXNcbiAgICAgIGlmIChyZXNwb25zZS5zdGF0dXMgPT09IDQwMykge1xuICAgICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBcbiAgICAgICAgICBlcnJvcjogJ0FjY2VzcyBkZW5pZWQuIE9CUyBzZXR0aW5ncyBhcmUgb25seSBhdmFpbGFibGUgZm9yIHN0cmVhbWVycyBhbmQgYWRtaW5pc3RyYXRvcnMuJyxcbiAgICAgICAgICBjb2RlOiAnQUNDRVNTX0RFTklFRCdcbiAgICAgICAgfSwgeyBzdGF0dXM6IDQwMyB9KTtcbiAgICAgIH1cbiAgICAgIFxuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKGVycm9yRGF0YSwgeyBzdGF0dXM6IHJlc3BvbnNlLnN0YXR1cyB9KTtcbiAgICB9XG5cbiAgICBjb25zdCBkYXRhID0gYXdhaXQgcmVzcG9uc2UuanNvbigpO1xuICAgIC8vIEVuc3VyZSB3aWRnZXRVcmwgaXMgcHJlc2VudCBmb3IgdGhlIGZyb250ZW5kXG4gICAgaWYgKGRhdGEgJiYgZGF0YS5zdHJlYW1lcklkICYmIGRhdGEuYWxlcnRUb2tlbiAmJiAhZGF0YS53aWRnZXRVcmwpIHtcbiAgICAgIGRhdGEud2lkZ2V0VXJsID0gYCR7QkFDS0VORF9VUkx9L2FwaS93aWRnZXQtcHVibGljL2FsZXJ0LyR7ZGF0YS5zdHJlYW1lcklkfS8ke2RhdGEuYWxlcnRUb2tlbn1gO1xuICAgIH1cbiAgICBjb25zb2xlLmxvZygn4pyFIFN1Y2Nlc3NmdWxseSByZXRyaWV2ZWQgT0JTIHNldHRpbmdzOicsIGRhdGEpO1xuICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihkYXRhKTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCfwn5KlIFVuZXhwZWN0ZWQgZXJyb3IgaW4gT0JTIHNldHRpbmdzIEFQSTonLCBlcnJvcik7XG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxuICAgICAgeyBlcnJvcjogJ0ZhaWxlZCB0byBmZXRjaCBPQlMgc2V0dGluZ3MnIH0sXG4gICAgICB7IHN0YXR1czogNTAwIH1cbiAgICApO1xuICB9XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBQT1NUKHJlcXVlc3Q6IE5leHRSZXF1ZXN0KSB7XG4gIHRyeSB7XG4gICAgLy8gR2V0IHRoZSBhdXRob3JpemF0aW9uIGhlYWRlclxuICAgIGNvbnN0IGF1dGhIZWFkZXIgPSByZXF1ZXN0LmhlYWRlcnMuZ2V0KCdhdXRob3JpemF0aW9uJyk7XG4gICAgXG4gICAgaWYgKCFhdXRoSGVhZGVyKSB7XG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBlcnJvcjogJ0F1dGhvcml6YXRpb24gaGVhZGVyIHJlcXVpcmVkJyB9LCB7IHN0YXR1czogNDAxIH0pO1xuICAgIH1cblxuICAgIC8vIEdldCB0aGUgcmVxdWVzdCBib2R5XG4gICAgY29uc3QgYm9keSA9IGF3YWl0IHJlcXVlc3QuanNvbigpO1xuXG4gICAgLy8gQ3JlYXRlIE9CUyBzZXR0aW5nc1xuICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2goYCR7QkFDS0VORF9VUkx9L2FwaS9vYnMtc2V0dGluZ3NgLCB7XG4gICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgJ0F1dGhvcml6YXRpb24nOiBhdXRoSGVhZGVyLFxuICAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nLFxuICAgICAgfSxcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KGJvZHkpLFxuICAgIH0pO1xuXG4gICAgaWYgKCFyZXNwb25zZS5vaykge1xuICAgICAgY29uc3QgZXJyb3JEYXRhID0gYXdhaXQgcmVzcG9uc2UuanNvbigpO1xuICAgICAgXG4gICAgICAvLyBIYW5kbGUgc3BlY2lmaWMgZXJyb3IgY2FzZXNcbiAgICAgIGlmIChyZXNwb25zZS5zdGF0dXMgPT09IDQwMykge1xuICAgICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBcbiAgICAgICAgICBlcnJvcjogJ0FjY2VzcyBkZW5pZWQuIE9CUyBzZXR0aW5ncyBhcmUgb25seSBhdmFpbGFibGUgZm9yIHN0cmVhbWVycyBhbmQgYWRtaW5pc3RyYXRvcnMuJyxcbiAgICAgICAgICBjb2RlOiAnQUNDRVNTX0RFTklFRCdcbiAgICAgICAgfSwgeyBzdGF0dXM6IDQwMyB9KTtcbiAgICAgIH1cbiAgICAgIFxuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKGVycm9yRGF0YSwgeyBzdGF0dXM6IHJlc3BvbnNlLnN0YXR1cyB9KTtcbiAgICB9XG5cbiAgICBjb25zdCBkYXRhID0gYXdhaXQgcmVzcG9uc2UuanNvbigpO1xuICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihkYXRhLCB7IHN0YXR1czogMjAxIH0pO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGNyZWF0aW5nIE9CUyBzZXR0aW5nczonLCBlcnJvcik7XG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxuICAgICAgeyBlcnJvcjogJ0ZhaWxlZCB0byBjcmVhdGUgT0JTIHNldHRpbmdzJyB9LFxuICAgICAgeyBzdGF0dXM6IDUwMCB9XG4gICAgKTtcbiAgfVxufSBcblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIFBBVENIKHJlcXVlc3Q6IE5leHRSZXF1ZXN0KSB7XG4gIHRyeSB7XG4gICAgY29uc29sZS5sb2coJ/CfmoAgUEFUQ0ggcmVxdWVzdCByZWNlaXZlZCBmb3IgT0JTIHNldHRpbmdzJyk7XG4gICAgXG4gICAgLy8gR2V0IHRoZSBhdXRob3JpemF0aW9uIGhlYWRlclxuICAgIGNvbnN0IGF1dGhIZWFkZXIgPSByZXF1ZXN0LmhlYWRlcnMuZ2V0KCdhdXRob3JpemF0aW9uJyk7XG4gICAgXG4gICAgaWYgKCFhdXRoSGVhZGVyKSB7XG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBlcnJvcjogJ0F1dGhvcml6YXRpb24gaGVhZGVyIHJlcXVpcmVkJyB9LCB7IHN0YXR1czogNDAxIH0pO1xuICAgIH1cblxuICAgIC8vIExvZyByZXF1ZXN0IGRldGFpbHMgZm9yIGRlYnVnZ2luZ1xuICAgIGNvbnN0IGNvbnRlbnRMZW5ndGggPSByZXF1ZXN0LmhlYWRlcnMuZ2V0KCdjb250ZW50LWxlbmd0aCcpO1xuICAgIGNvbnN0IGNvbnRlbnRUeXBlID0gcmVxdWVzdC5oZWFkZXJzLmdldCgnY29udGVudC10eXBlJyk7XG4gICAgY29uc29sZS5sb2coJ/Cfk50gUmVxdWVzdCBjb250ZW50LWxlbmd0aCBoZWFkZXI6JywgY29udGVudExlbmd0aCk7XG4gICAgY29uc29sZS5sb2coJ/Cfk50gUmVxdWVzdCBjb250ZW50LXR5cGU6JywgY29udGVudFR5cGUpO1xuICAgIGNvbnNvbGUubG9nKCfwn5OdIFJlcXVlc3QgbWV0aG9kOicsIHJlcXVlc3QubWV0aG9kKTtcbiAgICBjb25zb2xlLmxvZygn8J+TnSBSZXF1ZXN0IFVSTDonLCByZXF1ZXN0LnVybCk7XG5cbiAgICAvLyBVc2UgY3VzdG9tIGJvZHkgcGFyc2VyIGZvciBsYXJnZSBwYXlsb2Fkc1xuICAgIGNvbnNvbGUubG9nKCfwn5SEIFN0YXJ0aW5nIHRvIHBhcnNlIHJlcXVlc3QgYm9keS4uLicpO1xuICAgIGNvbnN0IGJvZHkgPSBhd2FpdCBwYXJzZUJvZHkocmVxdWVzdCk7XG4gICAgXG4gICAgY29uc29sZS5sb2coJ/Cfk50gUGFyc2VkIHJlcXVlc3QgYm9keSBzaXplOicsIEpTT04uc3RyaW5naWZ5KGJvZHkpLmxlbmd0aCwgJ2NoYXJhY3RlcnMnKTtcbiAgICBjb25zb2xlLmxvZygn8J+TnSBCb2R5IGtleXM6JywgT2JqZWN0LmtleXMoYm9keSkpO1xuXG4gICAgLy8gQ2hlY2sgaWYgYm9keSBpcyB0b28gbGFyZ2UgZm9yIGJhY2tlbmRcbiAgICBjb25zdCBib2R5U2l6ZSA9IEpTT04uc3RyaW5naWZ5KGJvZHkpLmxlbmd0aDtcbiAgICBpZiAoYm9keVNpemUgPiA1MCAqIDEwMjQgKiAxMDI0KSB7IC8vIDUwTUIgbGltaXQgZm9yIGJhY2tlbmRcbiAgICAgIGNvbnNvbGUud2Fybign4pqg77iPIEJvZHkgc2l6ZSBleGNlZWRzIDUwTUIsIG1heSBjYXVzZSBiYWNrZW5kIGlzc3VlcycpO1xuICAgIH1cblxuICAgIC8vIFVwZGF0ZSBPQlMgc2V0dGluZ3NcbiAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKGAke0JBQ0tFTkRfVVJMfS9hcGkvb2JzLXNldHRpbmdzL215LXNldHRpbmdzYCwge1xuICAgICAgbWV0aG9kOiAnUEFUQ0gnLFxuICAgICAgaGVhZGVyczoge1xuICAgICAgICAnQXV0aG9yaXphdGlvbic6IGF1dGhIZWFkZXIsXG4gICAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicsXG4gICAgICB9LFxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoYm9keSksXG4gICAgfSk7XG5cbiAgICBpZiAoIXJlc3BvbnNlLm9rKSB7XG4gICAgICBjb25zdCBlcnJvckRhdGEgPSBhd2FpdCByZXNwb25zZS5qc29uKCk7XG4gICAgICBjb25zb2xlLmVycm9yKCfinYwgQmFja2VuZCByZXNwb25zZSBlcnJvcjonLCByZXNwb25zZS5zdGF0dXMsIGVycm9yRGF0YSk7XG4gICAgICBcbiAgICAgIC8vIEhhbmRsZSBzcGVjaWZpYyBlcnJvciBjYXNlc1xuICAgICAgaWYgKHJlc3BvbnNlLnN0YXR1cyA9PT0gNDAzKSB7XG4gICAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IFxuICAgICAgICAgIGVycm9yOiAnQWNjZXNzIGRlbmllZC4gT0JTIHNldHRpbmdzIGFyZSBvbmx5IGF2YWlsYWJsZSBmb3Igc3RyZWFtZXJzIGFuZCBhZG1pbmlzdHJhdG9ycy4nLFxuICAgICAgICAgIGNvZGU6ICdBQ0NFU1NfREVOSUVEJ1xuICAgICAgICB9LCB7IHN0YXR1czogNDAzIH0pO1xuICAgICAgfVxuICAgICAgXG4gICAgICBpZiAocmVzcG9uc2Uuc3RhdHVzID09PSA0MDQpIHtcbiAgICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgXG4gICAgICAgICAgZXJyb3I6ICdPQlMgc2V0dGluZ3Mgbm90IGZvdW5kLiBQbGVhc2UgY3JlYXRlIHNldHRpbmdzIGZpcnN0LicsXG4gICAgICAgICAgY29kZTogJ1NFVFRJTkdTX05PVF9GT1VORCdcbiAgICAgICAgfSwgeyBzdGF0dXM6IDQwNCB9KTtcbiAgICAgIH1cbiAgICAgIFxuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKGVycm9yRGF0YSwgeyBzdGF0dXM6IHJlc3BvbnNlLnN0YXR1cyB9KTtcbiAgICB9XG5cbiAgICBjb25zdCBkYXRhID0gYXdhaXQgcmVzcG9uc2UuanNvbigpO1xuICAgIGNvbnNvbGUubG9nKCfinIUgQmFja2VuZCB1cGRhdGUgc3VjY2Vzc2Z1bCcpO1xuICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihkYXRhLCB7IHN0YXR1czogMjAwIH0pO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIHVwZGF0aW5nIE9CUyBzZXR0aW5nczonLCBlcnJvcik7XG4gICAgXG4gICAgLy8gSGFuZGxlIHNwZWNpZmljIHBhcnNpbmcgZXJyb3JzXG4gICAgaWYgKGVycm9yIGluc3RhbmNlb2YgRXJyb3IgJiYgZXJyb3IubWVzc2FnZS5pbmNsdWRlcygnRmFpbGVkIHRvIHBhcnNlIHJlcXVlc3QgYm9keScpKSB7XG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBcbiAgICAgICAgZXJyb3I6ICdSZXF1ZXN0IHBheWxvYWQgaXMgdG9vIGxhcmdlIG9yIGludmFsaWQuIFBsZWFzZSBlbnN1cmUgZmlsZXMgYXJlIHVuZGVyIDUwTUIuJyxcbiAgICAgICAgY29kZTogJ1BBWUxPQURfVE9PX0xBUkdFJ1xuICAgICAgfSwgeyBzdGF0dXM6IDQxMyB9KTtcbiAgICB9XG4gICAgXG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxuICAgICAgeyBlcnJvcjogJ0ZhaWxlZCB0byB1cGRhdGUgT0JTIHNldHRpbmdzJyB9LFxuICAgICAgeyBzdGF0dXM6IDUwMCB9XG4gICAgKTtcbiAgfVxufSAiXSwibmFtZXMiOlsiTmV4dFJlc3BvbnNlIiwicmVzb2x2ZUJhY2tlbmRVcmwiLCJzZXJ2ZXJVcmwiLCJwcm9jZXNzIiwiZW52IiwiQkFDS0VORF9VUkwiLCJwdWJsaWNVcmwiLCJORVhUX1BVQkxJQ19CQUNLRU5EX1VSTCIsInVybCIsImluY2x1ZGVzIiwicmVwbGFjZSIsInBhcnNlQm9keSIsInJlcXVlc3QiLCJjb250ZW50VHlwZSIsImhlYWRlcnMiLCJnZXQiLCJmb3JtRGF0YSIsImJvZHkiLCJlbnRyaWVzIiwiQXJyYXkiLCJmcm9tIiwia2V5IiwidmFsdWUiLCJGaWxlIiwiYXJyYXlCdWZmZXIiLCJiYXNlNjQiLCJCdWZmZXIiLCJ0b1N0cmluZyIsIm5hbWUiLCJ0eXBlIiwic2l6ZSIsImRhdGEiLCJjb25zb2xlIiwibG9nIiwibGVuZ3RoIiwiZmlsZUVycm9yIiwiZXJyb3IiLCJFcnJvciIsInRleHQiLCJKU09OIiwicGFyc2UiLCJwYXJzZUVycm9yIiwiR0VUIiwiYXV0aEhlYWRlciIsImpzb24iLCJzdGF0dXMiLCJoZWFsdGhDaGVjayIsImZldGNoIiwibWV0aG9kIiwiY29kZSIsInNldHRpbmdzVXJsIiwicmVzcG9uc2UiLCJzdGF0dXNUZXh0IiwicHJvZmlsZVJlc3BvbnNlIiwib2siLCJlcnJvckRhdGEiLCJwcm9maWxlRGF0YSIsIk9iamVjdCIsImtleXMiLCJ1c2VySWQiLCJ1c2VyIiwiaWQiLCJzdHJpbmdpZnkiLCJjcmVhdGVSZXNwb25zZSIsInN0cmVhbWVySWQiLCJpbWFnZVNldHRpbmdzIiwiZW5hYmxlZCIsIm1lZGlhVHlwZSIsIndpZHRoIiwiaGVpZ2h0IiwiYm9yZGVyUmFkaXVzIiwic2hhZG93Iiwic2hhZG93Q29sb3IiLCJzaGFkb3dCbHVyIiwic2hhZG93T2Zmc2V0WCIsInNoYWRvd09mZnNldFkiLCJzb3VuZFNldHRpbmdzIiwidm9sdW1lIiwiZmFkZUluIiwiZmFkZU91dCIsImxvb3AiLCJhbmltYXRpb25TZXR0aW5ncyIsImFuaW1hdGlvblR5cGUiLCJkdXJhdGlvbiIsImVhc2luZyIsImRpcmVjdGlvbiIsImJvdW5jZUludGVuc2l0eSIsInpvb21TY2FsZSIsInN0eWxlU2V0dGluZ3MiLCJiYWNrZ3JvdW5kQ29sb3IiLCJ0ZXh0Q29sb3IiLCJhY2NlbnRDb2xvciIsImJvcmRlckNvbG9yIiwiYm9yZGVyV2lkdGgiLCJib3JkZXJTdHlsZSIsImZvbnRGYW1pbHkiLCJmb250U2l6ZSIsImZvbnRXZWlnaHQiLCJmb250U3R5bGUiLCJ0ZXh0U2hhZG93IiwidGV4dFNoYWRvd0NvbG9yIiwidGV4dFNoYWRvd0JsdXIiLCJ0ZXh0U2hhZG93T2Zmc2V0WCIsInRleHRTaGFkb3dPZmZzZXRZIiwicG9zaXRpb25TZXR0aW5ncyIsIngiLCJ5IiwiYW5jaG9yIiwiekluZGV4IiwicmVzcG9uc2l2ZSIsIm1vYmlsZVNjYWxlIiwiZGlzcGxheVNldHRpbmdzIiwiZmFkZUluRHVyYXRpb24iLCJmYWRlT3V0RHVyYXRpb24iLCJhdXRvSGlkZSIsInNob3dQcm9ncmVzcyIsInByb2dyZXNzQ29sb3IiLCJwcm9ncmVzc0hlaWdodCIsImdlbmVyYWxTZXR0aW5ncyIsIm1heEFsZXJ0cyIsImFsZXJ0U3BhY2luZyIsImNvb2xkb3duIiwicHJpb3JpdHkiLCJpc0FjdGl2ZSIsImFsZXJ0VG9rZW4iLCJ3aWRnZXRVcmwiLCJQT1NUIiwiUEFUQ0giLCJjb250ZW50TGVuZ3RoIiwiYm9keVNpemUiLCJ3YXJuIiwibWVzc2FnZSJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./src/app/api/obs-settings/route.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next"], () => (__webpack_exec__("(rsc)/../node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fobs-settings%2Froute&page=%2Fapi%2Fobs-settings%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fobs-settings%2Froute.ts&appDir=D%3A%5Crepo%5Cxscan%5Cfrontend%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=D%3A%5Crepo%5Cxscan%5Cfrontend&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=standalone&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();