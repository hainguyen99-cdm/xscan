"use strict";(()=>{var e={};e.id=6271,e.ids=[6271],e.modules={30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},21329:(e,t,r)=>{r.r(t),r.d(t,{headerHooks:()=>f,originalPathname:()=>g,patchFetch:()=>w,requestAsyncStorage:()=>d,routeModule:()=>p,serverHooks:()=>h,staticGenerationAsyncStorage:()=>c,staticGenerationBailout:()=>m});var o={};r.r(o),r.d(o,{GET:()=>u,POST:()=>l});var a=r(6170),s=r(8533),n=r(54387),i=r(40064);async function u(e){try{let{searchParams:t}=new URL(e.url),r=t.get("username");if(!r)return i.Z.json({error:"Username parameter is required"},{status:400});let o=e.headers.get("authorization"),a=process.env.BACKEND_URL||"http://localhost:3001",s=await fetch(`${a}/api/users/streamer/${r}`,{method:"GET",headers:{"Content-Type":"application/json",...o&&{Authorization:o}}});if(!s.ok){if(404===s.status)return i.Z.json({error:"Streamer not found"},{status:404});throw Error(`Backend responded with status: ${s.status}`)}let n=await s.json();return i.Z.json(n)}catch(e){return console.error("Error fetching streamer profile:",e),i.Z.json({error:"Failed to fetch streamer profile"},{status:500})}}async function l(e){try{let{searchParams:t}=new URL(e.url),r=t.get("username"),o=t.get("action");if(console.log("Follow request:",{username:r,action:o}),!r||"follow"!==o)return i.Z.json({error:"Username and action=follow parameters are required"},{status:400});let a=e.headers.get("authorization"),s=a?.startsWith("Bearer ")?a.substring(7):a;if(console.log("Auth header:",a),console.log("Token extracted:",s?`${s.substring(0,10)}...`:"none"),!s)return i.Z.json({error:"Authentication required"},{status:401});let n=process.env.BACKEND_URL||"http://localhost:3001",u=await fetch(`${n}/api/users/streamer/${r}`,{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${s}`}});if(!u.ok){if(404===u.status)return i.Z.json({error:"Streamer not found"},{status:404});throw Error(`Failed to get streamer info: ${u.status}`)}let l=(await u.json()).id,p=await fetch(`${n}/api/users/${l}/follow`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${s}`}});if(!p.ok){if(404===p.status)return i.Z.json({error:"Streamer not found"},{status:404});if(401===p.status)return i.Z.json({error:"Authentication failed"},{status:401});throw Error(`Backend responded with status: ${p.status}`)}let d=await p.json();return i.Z.json(d)}catch(e){return console.error("Error toggling follow status:",e),i.Z.json({error:"Failed to update follow status"},{status:500})}}let p=new a.AppRouteRouteModule({definition:{kind:s.x.APP_ROUTE,page:"/api/streamer-profile/route",pathname:"/api/streamer-profile",filename:"route",bundlePath:"app/api/streamer-profile/route"},resolvedPagePath:"D:\\repo\\xscan\\frontend\\src\\app\\api\\streamer-profile\\route.ts",nextConfigOutput:"",userland:o}),{requestAsyncStorage:d,staticGenerationAsyncStorage:c,serverHooks:h,headerHooks:f,staticGenerationBailout:m}=p,g="/api/streamer-profile/route";function w(){return(0,n.patchFetch)({serverHooks:h,staticGenerationAsyncStorage:c})}}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),o=t.X(0,[3499,7386],()=>r(21329));module.exports=o})();