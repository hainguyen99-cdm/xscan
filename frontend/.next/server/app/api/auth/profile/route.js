"use strict";(()=>{var e={};e.id=1495,e.ids=[1495],e.modules={30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},84572:(e,r,t)=>{t.r(r),t.d(r,{headerHooks:()=>g,originalPathname:()=>h,patchFetch:()=>m,requestAsyncStorage:()=>d,routeModule:()=>c,serverHooks:()=>D,staticGenerationAsyncStorage:()=>p,staticGenerationBailout:()=>f});var o={};t.r(o),t.d(o,{GET:()=>l});var a=t(6170),s=t(8533),n=t(54387),u=t(40064);let i=process.env.BACKEND_URL||"http://localhost:3001";async function l(e){try{let r=e.headers.get("authorization");if(console.log("\uD83D\uDD0D Auth profile API called"),console.log("\uD83D\uDCE1 Backend URL:",i),console.log("\uD83D\uDD11 Auth header present:",!!r),console.log("\uD83D\uDD11 Auth header value:",r?r.substring(0,20)+"...":"None"),!r)return console.log("❌ No authorization header, returning 401"),u.Z.json({error:"Authorization header required"},{status:401});console.log("\uD83D\uDD0D Fetching user profile...");let t=await fetch(`${i}/api/auth/profile`,{headers:{Authorization:r,"Content-Type":"application/json"}});if(console.log(`📡 Backend profile response status: ${t.status}`),!t.ok){let e=await t.json();if(console.error("❌ Failed to fetch user profile:",e),404===t.status||500===t.status)return console.log("⚠️ Backend not available, returning mock streamer user for testing"),u.Z.json({id:"mock-streamer-123",email:"streamer@test.com",name:"Test Streamer",username:"teststreamer",role:"streamer",isActive:!0,isEmailVerified:!1,twoFactorEnabled:!1,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()});return u.Z.json(e,{status:t.status})}let o=await t.json();console.log("\uD83D\uDCE6 Raw backend response:",o),console.log("\uD83D\uDCE6 Response data type:",typeof o),console.log("\uD83D\uDCE6 Response data keys:",Object.keys(o));let a=o.user;if(console.log("\uD83D\uDC64 Extracted userData:",a),console.log("\uD83D\uDC64 UserData type:",typeof a),console.log("\uD83D\uDC64 UserData keys:",a?Object.keys(a):"null/undefined"),!a)return console.error("❌ Invalid user data structure from backend:",o),console.error("❌ Full response data:",JSON.stringify(o,null,2)),u.Z.json({error:"Invalid user data structure from backend"},{status:500});return console.log("✅ Successfully retrieved user profile:",{id:a.id,email:a.email,role:a.role}),console.log("✅ User ID for OBS settings:",a.id),u.Z.json(a)}catch(e){return console.error("\uD83D\uDCA5 Unexpected error in auth profile API:",e),console.log("⚠️ Error occurred, returning mock user data for testing"),u.Z.json({id:"mock-user-error-123",email:"error@example.com",name:"Error User",username:"erroruser",role:"streamer",isActive:!0,isEmailVerified:!1,twoFactorEnabled:!1,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()})}}let c=new a.AppRouteRouteModule({definition:{kind:s.x.APP_ROUTE,page:"/api/auth/profile/route",pathname:"/api/auth/profile",filename:"route",bundlePath:"app/api/auth/profile/route"},resolvedPagePath:"D:\\repo\\xscan\\frontend\\src\\app\\api\\auth\\profile\\route.ts",nextConfigOutput:"",userland:o}),{requestAsyncStorage:d,staticGenerationAsyncStorage:p,serverHooks:D,headerHooks:g,staticGenerationBailout:f}=c,h="/api/auth/profile/route";function m(){return(0,n.patchFetch)({serverHooks:D,staticGenerationAsyncStorage:p})}}};var r=require("../../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),o=r.X(0,[3499,7386],()=>t(84572));module.exports=o})();