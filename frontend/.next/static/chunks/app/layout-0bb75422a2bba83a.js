(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3185],{51004:function(e,t,n){Promise.resolve().then(n.t.bind(n,97732,23)),Promise.resolve().then(n.bind(n,13428)),Promise.resolve().then(n.bind(n,83899))},13428:function(e,t,n){"use strict";n.r(t),n.d(t,{Providers:function(){return d}});var r=n(37821),i=n(40935),o=n(89188),s=n(58078),a=n(46179),l=n(61414);function c(e){let{children:t}=e,{isAuthenticated:n,initializeAuth:i}=(0,l.qr)(),[o,c]=(0,s.useState)(!0),[u,d]=(0,s.useState)(!1),[h,g]=(0,s.useState)(null),m=(0,a.useRouter)(),f=(0,a.usePathname)(),x=["/login","/register","/forgot-password","/reset-password"],p=["/login","/forgot-password","/reset-password"],w=e=>{if(!e)return"/";let t=e.replace(/\/+$/,"");return 0===t.length?"/":t},b=(0,s.useCallback)(async()=>{try{console.log("Starting authentication initialization..."),g(null),await i(),console.log("Authentication initialization completed")}catch(e){console.error("Failed to initialize authentication:",e),e instanceof Error&&!e.message.includes("fetch")&&g(e.message)}finally{c(!1),d(!0)}},[i]);return((0,s.useEffect)(()=>{b()},[b]),(0,s.useEffect)(()=>{if(!o&&u){console.log("Running authentication checks for path:",f);let e=setTimeout(()=>{let e=w(f||"/"),t=x.map(w),r=p.map(w),s=t.includes(e),a=r.includes(e),l=localStorage.getItem("auth-token")||document.cookie.includes("auth-token=");if(console.log("Auth state check:",{isAuthenticated:n,pathname:e,isPublicRoute:s,isLoginOnlyRoute:a,authError:h,isInitializing:o,hasInitialized:u,hasToken:l}),n||s)n&&a&&(console.log("Redirecting to dashboard: authenticated on login-only route"),m.push("/dashboard"));else{if(l){console.log("Found token but not authenticated, attempting re-initialization..."),i().catch(console.error);return}console.log("Redirecting to login: not authenticated on protected route"),m.push("/login")}},500);return()=>clearTimeout(e)}},[n,f,o,u,m,x,p,h,i]),(0,s.useEffect)(()=>{if(!n||o)return;let e=setInterval(async()=>{try{console.log("Performing periodic token validation..."),await i()}catch(e){console.error("Periodic token validation failed:",e),g("Token validation failed")}},3e5);return()=>clearInterval(e)},[n,o,i]),o)?(0,r.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-600 mx-auto mb-4"}),(0,r.jsx)("p",{className:"text-gray-600",children:"Initializing authentication..."}),h&&(0,r.jsx)("p",{className:"text-red-500 text-sm mt-2",children:h}),(0,r.jsxs)("p",{className:"text-xs text-gray-400 mt-2",children:["Debug: ",n?"Authenticated":"Not authenticated"," |",u?"Initialized":"Not initialized"]})]})}):(0,r.jsx)(r.Fragment,{children:t})}let u=new i.S({defaultOptions:{queries:{retry:1,refetchOnWindowFocus:!1}}});function d(e){let{children:t}=e;return(0,r.jsx)(o.aH,{client:u,children:(0,r.jsx)(c,{children:t})})}},83899:function(e,t,n){"use strict";n.r(t),n.d(t,{ToastContainer:function(){return a},showToast:function(){return l}});var r=n(37821),i=n(58078),o=n(40457);function s(e){let{toast:t,onRemove:n}=e;return(0,i.useEffect)(()=>{let e=setTimeout(()=>{n(t.id)},t.duration||5e3);return()=>clearTimeout(e)},[t.id,t.duration,n]),(0,r.jsx)("div",{className:"".concat((()=>{switch(t.type){case"success":return"bg-green-50 border-green-200 text-green-800";case"error":return"bg-red-50 border-red-200 text-red-800";case"warning":return"bg-yellow-50 border-yellow-200 text-yellow-800";case"info":return"bg-blue-50 border-blue-200 text-blue-800";default:return"bg-gray-50 border-gray-200 text-gray-800"}})()," border rounded-lg p-4 shadow-lg max-w-sm w-full transition-all duration-300 ease-in-out transform translate-x-0 opacity-100"),children:(0,r.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,r.jsx)("span",{className:"text-lg",children:(()=>{switch(t.type){case"success":return"✅";case"error":return"❌";case"warning":return"⚠️";default:return"ℹ️"}})()}),(0,r.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,r.jsx)("p",{className:"font-medium text-sm",children:t.title}),t.message&&(0,r.jsx)("p",{className:"text-sm mt-1 opacity-90",children:t.message})]}),(0,r.jsx)("button",{onClick:()=>n(t.id),className:"text-gray-400 hover:text-gray-600 transition-colors",children:"✕"})]})})}function a(){let[e,t]=(0,i.useState)([]),n=e=>{t(t=>t.filter(t=>t.id!==e))},a=e=>{let n=Math.random().toString(36).substr(2,9);t(t=>[...t,{...e,id:n}])};return(0,i.useEffect)(()=>(window.showToast=a,()=>{delete window.showToast}),[]),(0,o.createPortal)((0,r.jsx)("div",{className:"fixed top-4 right-4 z-50 space-y-2",children:e.map(e=>(0,r.jsx)(s,{toast:e,onRemove:n},e.id))}),document.body)}let l=e=>{window.showToast&&window.showToast(e)}},97732:function(){}},function(e){e.O(0,[4885,4952,9250,189,1414,7115,141,1744],function(){return e(e.s=51004)}),_N_E=e.O()}]);