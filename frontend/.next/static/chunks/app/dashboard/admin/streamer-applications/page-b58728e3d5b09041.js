(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3414],{22195:function(e,s,t){Promise.resolve().then(t.bind(t,63013))},63013:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return c},dynamic:function(){return o}});var r=t(37821),a=t(58078),n=t(46179),i=t(61414),l=t(30189),d=t(54377);let o="force-dynamic";function c(){let e=(0,n.useRouter)(),{user:s,isAuthenticated:t}=(0,i.qr)(),[o,c]=(0,a.useState)(!0),[m,x]=(0,a.useState)([]),[p,h]=(0,a.useState)(0),[u,g]=(0,a.useState)(1),[j,f]=(0,a.useState)(10),[b,y]=(0,a.useState)("all"),[v,N]=(0,a.useState)(""),[w,S]=(0,a.useState)(null),[A,C]=(0,a.useState)(null);(0,a.useEffect)(()=>{if(!t){e.push("/login");return}if((null==s?void 0:s.role)!=="admin"){e.push("/dashboard");return}R()},[t,s,e,u,j,b,v]);let R=async()=>{try{let e=(0,l.hV)();if(!e)throw Error("Authentication required");let s=new URLSearchParams({page:u.toString(),limit:j.toString()});"all"!==b&&s.append("status",b),v.trim()&&s.append("search",v.trim()),console.log("Fetching applications with params:",s.toString());let t=await fetch("/api/admin/streamer-applications?".concat(s),{headers:{Authorization:"Bearer ".concat(e)}});if(console.log("Response status:",t.status),console.log("Response headers:",Object.fromEntries(t.headers.entries())),!t.ok)throw Error("Failed to fetch applications");let r=await t.json();console.log("Received data:",r),x(r.items||[]),h(r.total||0)}catch(e){console.error("Failed to fetch applications:",e),C({type:"error",text:"Failed to load applications"})}finally{c(!1)}},k=async(e,s,t)=>{S(e),C(null);try{let r=(0,l.hV)();if(!r)throw Error("Authentication required");let a=await fetch("/api/admin/streamer-applications/".concat(e,"/review"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(r)},body:JSON.stringify({action:s,notes:t})}),n=await a.json();if(!a.ok)throw Error(n.message||"Failed to process application");C({type:"success",text:"Application ".concat("approve"===s?"approved":"rejected"," successfully")}),R()}catch(e){C({type:"error",text:e instanceof Error?e.message:"Failed to process application"})}finally{S(null)}},_=e=>{switch(e){case"pending":return(0,r.jsx)("span",{className:"px-2 py-1 text-xs font-medium bg-yellow-100 text-yellow-800 rounded-full",children:"Pending"});case"approved":return(0,r.jsx)("span",{className:"px-2 py-1 text-xs font-medium bg-green-100 text-green-800 rounded-full",children:"Approved"});case"rejected":return(0,r.jsx)("span",{className:"px-2 py-1 text-xs font-medium bg-red-100 text-red-800 rounded-full",children:"Rejected"});default:return(0,r.jsx)("span",{className:"px-2 py-1 text-xs font-medium bg-gray-100 text-gray-800 rounded-full",children:"Unknown"})}},E=e=>new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),P=Math.ceil(p/j);return o?(0,r.jsx)(d.Z,{children:(0,r.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-500 mx-auto mb-4"}),(0,r.jsx)("p",{className:"text-gray-600",children:"Loading applications..."})]})})}):(0,r.jsx)(d.Z,{children:(0,r.jsxs)("div",{className:"max-w-7xl mx-auto p-6",children:[(0,r.jsxs)("div",{className:"mb-8",children:[(0,r.jsx)("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Streamer Applications"}),(0,r.jsx)("p",{className:"text-gray-600",children:"Review and manage streamer registration applications."})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[(0,r.jsxs)("div",{className:"bg-white p-4 rounded-lg border border-gray-200",children:[(0,r.jsx)("div",{className:"text-2xl font-bold text-gray-900",children:p}),(0,r.jsx)("div",{className:"text-sm text-gray-600",children:"Total Applications"})]}),(0,r.jsxs)("div",{className:"bg-white p-4 rounded-lg border border-gray-200",children:[(0,r.jsx)("div",{className:"text-2xl font-bold text-yellow-600",children:m.filter(e=>"pending"===e.status).length}),(0,r.jsx)("div",{className:"text-sm text-gray-600",children:"Pending Review"})]}),(0,r.jsxs)("div",{className:"bg-white p-4 rounded-lg border border-gray-200",children:[(0,r.jsx)("div",{className:"text-2xl font-bold text-green-600",children:m.filter(e=>"approved"===e.status).length}),(0,r.jsx)("div",{className:"text-sm text-gray-600",children:"Approved"})]}),(0,r.jsxs)("div",{className:"bg-white p-4 rounded-lg border border-gray-200",children:[(0,r.jsx)("div",{className:"text-2xl font-bold text-red-600",children:m.filter(e=>"rejected"===e.status).length}),(0,r.jsx)("div",{className:"text-sm text-gray-600",children:"Rejected"})]})]}),(0,r.jsx)("div",{className:"bg-white p-4 rounded-lg border border-gray-200 mb-6",children:(0,r.jsxs)("div",{className:"flex flex-col md:flex-row gap-4",children:[(0,r.jsx)("div",{className:"flex-1",children:(0,r.jsx)("input",{type:"text",placeholder:"Search by username, display name, or email...",value:v,onChange:e=>N(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500"})}),(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsxs)("select",{value:b,onChange:e=>y(e.target.value),className:"px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500",children:[(0,r.jsx)("option",{value:"all",children:"All Statuses"}),(0,r.jsx)("option",{value:"pending",children:"Pending"}),(0,r.jsx)("option",{value:"approved",children:"Approved"}),(0,r.jsx)("option",{value:"rejected",children:"Rejected"})]}),(0,r.jsxs)("select",{value:j,onChange:e=>f(Number(e.target.value)),className:"px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500",children:[(0,r.jsx)("option",{value:5,children:"5 per page"}),(0,r.jsx)("option",{value:10,children:"10 per page"}),(0,r.jsx)("option",{value:20,children:"20 per page"}),(0,r.jsx)("option",{value:50,children:"50 per page"})]})]})]})}),A&&(0,r.jsx)("div",{className:"mb-6 p-4 rounded-lg ".concat("success"===A.type?"bg-green-50 border border-green-200 text-green-800":"bg-red-50 border border-red-200 text-red-800"),children:A.text}),0===m.length?(0,r.jsxs)("div",{className:"text-center py-12 bg-white rounded-lg border border-gray-200",children:[(0,r.jsx)("div",{className:"text-gray-400 text-4xl mb-4",children:"\uD83D\uDCDD"}),(0,r.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No applications found"}),(0,r.jsx)("p",{className:"text-gray-600",children:v||"all"!==b?"Try adjusting your search criteria or filters.":"There are currently no streamer applications to review."})]}):(0,r.jsx)("div",{className:"space-y-6",children:m.map(e=>(0,r.jsxs)("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[(0,r.jsxs)("div",{className:"flex items-start justify-between mb-4",children:[(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-3 mb-2",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:e.displayName}),_(e.status)]}),(0,r.jsxs)("p",{className:"text-sm text-gray-600",children:["@",e.username]})]}),(0,r.jsxs)("div",{className:"text-right",children:[(0,r.jsx)("p",{className:"text-sm text-gray-500",children:"Applied on"}),(0,r.jsx)("p",{className:"text-sm font-medium text-gray-900",children:E(e.createdAt)})]})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h4",{className:"text-sm font-medium text-gray-900 mb-2",children:"Basic Information"}),(0,r.jsxs)("div",{className:"space-y-2 text-sm text-gray-600",children:[(0,r.jsxs)("p",{children:[(0,r.jsx)("span",{className:"font-medium",children:"Email:"})," ",e.email]}),(0,r.jsxs)("p",{children:[(0,r.jsx)("span",{className:"font-medium",children:"Platform:"})," ",e.platform]}),(0,r.jsxs)("p",{children:[(0,r.jsx)("span",{className:"font-medium",children:"Channel URL:"}),(0,r.jsx)("a",{href:e.channelUrl,target:"_blank",rel:"noopener noreferrer",className:"text-indigo-600 hover:text-indigo-700 ml-1",children:e.channelUrl})]}),(0,r.jsxs)("p",{children:[(0,r.jsx)("span",{className:"font-medium",children:"Monthly Viewers:"})," ",e.monthlyViewers.toLocaleString()]}),(0,r.jsxs)("p",{children:[(0,r.jsx)("span",{className:"font-medium",children:"Content Category:"})," ",e.contentCategory]}),e.referrer&&(0,r.jsxs)("p",{children:[(0,r.jsx)("span",{className:"font-medium",children:"Referrer:"})," ",e.referrer]})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h4",{className:"text-sm font-medium text-gray-900 mb-2",children:"Content Details"}),(0,r.jsxs)("div",{className:"space-y-2 text-sm text-gray-600",children:[(0,r.jsx)("p",{children:(0,r.jsx)("span",{className:"font-medium",children:"Description:"})}),(0,r.jsx)("p",{className:"text-gray-700 bg-gray-50 p-2 rounded",children:e.description})]})]})]}),(0,r.jsxs)("div",{className:"mb-4",children:[(0,r.jsx)("h4",{className:"text-sm font-medium text-gray-900 mb-2",children:"Reason for Applying"}),(0,r.jsx)("p",{className:"text-sm text-gray-700 bg-gray-50 p-3 rounded",children:e.reasonForApplying})]}),"pending"===e.status&&(0,r.jsxs)("div",{className:"flex space-x-3 pt-4 border-t border-gray-200",children:[(0,r.jsx)("button",{onClick:()=>{let s=prompt("Add review notes (optional):");k(e._id,"approve",s||void 0)},disabled:w===e._id,className:"px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 disabled:opacity-50 disabled:cursor-not-allowed",children:w===e._id?"Processing...":"Approve"}),(0,r.jsx)("button",{onClick:()=>{let s=prompt("Add rejection reason (optional):");k(e._id,"reject",s||void 0)},disabled:w===e._id,className:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 disabled:opacity-50 disabled:cursor-not-allowed",children:w===e._id?"Processing...":"Reject"})]}),("approved"===e.status||"rejected"===e.status)&&(0,r.jsx)("div",{className:"pt-4 border-t border-gray-200",children:(0,r.jsxs)("div",{className:"text-sm text-gray-600",children:[(0,r.jsxs)("p",{children:[(0,r.jsx)("span",{className:"font-medium",children:"Reviewed on:"})," ",e.reviewedAt?E(e.reviewedAt):"Unknown"]}),e.reviewNotes&&(0,r.jsxs)("div",{className:"mt-2",children:[(0,r.jsx)("p",{children:(0,r.jsx)("span",{className:"font-medium",children:"Review Notes:"})}),(0,r.jsx)("p",{className:"text-gray-700 bg-gray-50 p-2 rounded mt-1",children:e.reviewNotes})]})]})})]},e._id))}),P>1&&(0,r.jsx)("div",{className:"mt-8 flex justify-center",children:(0,r.jsxs)("nav",{className:"flex space-x-2",children:[(0,r.jsx)("button",{onClick:()=>g(Math.max(1,u-1)),disabled:1===u,className:"px-3 py-2 text-sm font-medium text-gray-500 bg-white border border-gray-300 rounded-md hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Previous"}),Array.from({length:Math.min(5,P)},(e,s)=>{let t=Math.max(1,Math.min(P-4,u-2))+s;return(0,r.jsx)("button",{onClick:()=>g(t),className:"px-3 py-2 text-sm font-medium rounded-md ".concat(t===u?"bg-indigo-600 text-white":"text-gray-500 bg-white border border-gray-300 hover:bg-gray-50"),children:t},t)}),(0,r.jsx)("button",{onClick:()=>g(Math.min(P,u+1)),disabled:u===P,className:"px-3 py-2 text-sm font-medium text-gray-500 bg-white border border-gray-300 rounded-md hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Next"})]})}),m.length>0&&(0,r.jsxs)("div",{className:"mt-4 text-center text-sm text-gray-600",children:["Showing ",(u-1)*j+1," to ",Math.min(u*j,p)," of ",p," applications"]})]})})}},54377:function(e,s,t){"use strict";t.d(s,{Z:function(){return i}});var r=t(37821);t(58078);var a=t(61414),n=t(64944);function i(e){let{children:s}=e,{sidebarOpen:t,toggleSidebar:i}=(0,a.HB)();return(0,r.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-indigo-50 via-white to-cyan-50",children:[(0,r.jsx)(n.Header,{}),(0,r.jsx)("main",{className:"relative",children:s})]})}}},function(e){e.O(0,[4885,4952,5052,189,1414,4944,7115,141,1744],function(){return e(e.s=22195)}),_N_E=e.O()}]);