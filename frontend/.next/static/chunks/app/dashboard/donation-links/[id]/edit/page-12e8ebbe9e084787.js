(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6960],{49686:function(e,t,n){Promise.resolve().then(n.bind(n,30697))},30697:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return u},dynamic:function(){return c}});var i=n(37821),s=n(58078),r=n(46179),a=n(39788),o=n(61414),l=n(30189),d=n(54377);let c="force-dynamic";function u(){let e=(0,r.useRouter)(),t=(0,r.useParams)().id,{donationLinks:n,updateDonationLink:c,user:u,isAuthenticated:m}=(0,o.qr)(),{isAuthenticating:h}=(0,o.tN)(),[x,f]=(0,s.useState)(!0),[g,b]=(0,s.useState)(!1),[j,v]=(0,s.useState)(null),[p,N]=(0,s.useState)(null);(0,s.useEffect)(()=>{h||m&&((null==u?void 0:u.role)==="streamer"||(null==u?void 0:u.role)==="admin")||e.push("/login?redirect=/dashboard/donation-links")},[h,m,null==u?void 0:u.role,e]),(0,s.useEffect)(()=>{if((n||[]).length>0&&t){let e=(n||[]).find(e=>(e.id||e._id||e.slug||e.customUrl)===t);e?N(e):v("Donation link not found"),f(!1)}else 0!==(n||[]).length||x||y()},[n,t]);let y=async()=>{if(t)try{f(!0);let e=(0,l.hV)();if(!e)throw Error("Authentication required");let n=await fetch("/api/donation-links/".concat(t),{headers:{Authorization:"Bearer ".concat(e)}});if(!n.ok)throw Error("Failed to fetch donation link");let i=await n.json();N(i.data||i)}catch(e){v(e instanceof Error?e.message:"Failed to fetch donation link")}finally{f(!1)}},k=async n=>{if(p){b(!0),v(null);try{let i=(0,l.hV)();if(!i)throw Error("Authentication required");let s=await fetch("/api/donation-links/".concat(t),{method:"PUT",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(i)},body:JSON.stringify(n)});if(!s.ok){let e=await s.json();throw Error(e.message||"Failed to update donation link")}let r=await s.json();c(p.id,r.data||r),e.push("/dashboard/donation-links")}catch(e){v(e instanceof Error?e.message:"An unexpected error occurred")}finally{b(!1)}}};if(h||x)return(0,i.jsx)(d.Z,{children:(0,i.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,i.jsxs)("div",{className:"text-center",children:[(0,i.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-500 mx-auto mb-4"}),(0,i.jsx)("p",{className:"text-gray-600",children:"Loading..."})]})})});if(!m||(null==u?void 0:u.role)!=="streamer"&&(null==u?void 0:u.role)!=="admin")return(0,i.jsx)(d.Z,{children:(0,i.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,i.jsxs)("div",{className:"text-center",children:[(0,i.jsx)("div",{className:"text-red-500 text-6xl mb-4",children:"\uD83D\uDEAB"}),(0,i.jsx)("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Access Denied"}),(0,i.jsx)("p",{className:"text-gray-600 mb-4",children:"You need to be logged in as a streamer or admin to edit donation links."}),(0,i.jsx)("button",{onClick:()=>e.push("/login"),className:"px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700",children:"Go to Login"})]})})});if(j||!p)return(0,i.jsx)(d.Z,{children:(0,i.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,i.jsxs)("div",{className:"text-center",children:[(0,i.jsx)("div",{className:"text-red-500 text-6xl mb-4",children:"âŒ"}),(0,i.jsx)("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Error"}),(0,i.jsx)("p",{className:"text-gray-600 mb-4",children:j||"Donation link not found"}),(0,i.jsx)("button",{onClick:()=>e.push("/dashboard/donation-links"),className:"px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700",children:"Back to Donation Links"})]})})});let w={title:p.title,description:p.description||"",customUrl:p.customUrl,isActive:p.isActive,allowAnonymous:p.allowAnonymous,theme:p.theme};return(0,i.jsx)(d.Z,{children:(0,i.jsxs)("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8",children:[(0,i.jsx)("div",{className:"mb-8",children:(0,i.jsxs)("div",{className:"flex items-center justify-between",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Edit Donation Link"}),(0,i.jsx)("p",{className:"mt-2 text-gray-600",children:"Update your donation page settings and customization."})]}),(0,i.jsx)("button",{onClick:()=>e.push("/dashboard/donation-links"),className:"inline-flex items-center px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:"Cancel"})]})}),j&&(0,i.jsx)("div",{className:"mb-6 bg-red-50 border border-red-200 rounded-md p-4",children:(0,i.jsxs)("div",{className:"flex",children:[(0,i.jsx)("div",{className:"flex-shrink-0",children:(0,i.jsx)("svg",{className:"h-5 w-5 text-red-400",viewBox:"0 0 20 20",fill:"currentColor",children:(0,i.jsx)("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})})}),(0,i.jsxs)("div",{className:"ml-3",children:[(0,i.jsx)("h3",{className:"text-sm font-medium text-red-800",children:"Error"}),(0,i.jsx)("div",{className:"mt-2 text-sm text-red-700",children:j})]})]})}),(0,i.jsx)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:(0,i.jsx)(a.p,{initialData:w,onSubmit:k,isLoading:g,submitButtonText:"Update Donation Link"})})]})})}},54377:function(e,t,n){"use strict";n.d(t,{Z:function(){return a}});var i=n(37821);n(58078);var s=n(61414),r=n(64944);function a(e){let{children:t}=e,{sidebarOpen:n,toggleSidebar:a}=(0,s.HB)();return(0,i.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-indigo-50 via-white to-cyan-50",children:[(0,i.jsx)(r.Header,{}),(0,i.jsx)("main",{className:"relative",children:t})]})}}},function(e){e.O(0,[4885,4952,5052,189,1414,4944,9788,7115,141,1744],function(){return e(e.s=49686)}),_N_E=e.O()}]);