(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8372],{67852:function(e,s,n){Promise.resolve().then(n.bind(n,70413))},70413:function(e,s,n){"use strict";n.r(s),n.d(s,{default:function(){return c},dynamic:function(){return d}});var t=n(37821),r=n(58078),i=n(46179),o=n(39788),l=n(61414),a=n(30189);let d="force-dynamic";function c(){let e=(0,i.useRouter)(),{addDonationLink:s,user:n,isAuthenticated:d}=(0,l.qr)(),{isAuthenticating:c}=(0,l.tN)(),[u,m]=(0,r.useState)(!1),[h,x]=(0,r.useState)(null);(0,r.useEffect)(()=>{console.log("\uD83D\uDD0D Auth state check:",{isAuthenticating:c,isAuthenticated:d,userRole:null==n?void 0:n.role,user:n,token:(0,a.hV)()}),c||d&&(null==n?void 0:n.role)==="streamer"?console.log("✅ Access granted to donation links create page"):(console.log("❌ Access denied, redirecting to login"),console.log("❌ Reason:",{isAuthenticating:c,isAuthenticated:d,userRole:null==n?void 0:n.role,hasUser:!!n}),e.push("/login?redirect=/donation-links/create"))},[c,d,null==n?void 0:n.role,e]);let g=async n=>{m(!0),x(null);try{let t=(0,a.hV)();if(!t)throw Error("Authentication required");let r=await fetch("/api/donation-links",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(t)},body:JSON.stringify(n)});if(!r.ok){let e=await r.json();throw Error(e.message||"Failed to create donation link")}let i=await r.json();s(i.data),e.push("/dashboard/donation-links")}catch(e){x(e instanceof Error?e.message:"An unexpected error occurred")}finally{m(!1)}};return c?(0,t.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-500 mx-auto mb-4"}),(0,t.jsx)("p",{className:"text-gray-600",children:"Loading..."})]})}):d&&(null==n?void 0:n.role)==="streamer"?(0,t.jsx)("div",{className:"min-h-screen bg-gray-50 py-8",children:(0,t.jsxs)("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8",children:[(0,t.jsx)("div",{className:"mb-8",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Create Donation Link"}),(0,t.jsx)("p",{className:"mt-2 text-gray-600",children:"Set up a new donation page for your stream and start receiving support from your audience."})]}),(0,t.jsxs)("button",{onClick:()=>e.back(),className:"inline-flex items-center px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:[(0,t.jsx)("svg",{className:"w-4 h-4 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 19l-7-7m0 0l7-7m-7 7h18"})}),"Back"]})]})}),h&&(0,t.jsx)("div",{className:"mb-6 bg-red-50 border border-red-200 rounded-md p-4",children:(0,t.jsxs)("div",{className:"flex",children:[(0,t.jsx)("div",{className:"flex-shrink-0",children:(0,t.jsx)("svg",{className:"h-5 w-5 text-red-400",viewBox:"0 0 20 20",fill:"currentColor",children:(0,t.jsx)("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})})}),(0,t.jsxs)("div",{className:"ml-3",children:[(0,t.jsx)("h3",{className:"text-sm font-medium text-red-800",children:"Error"}),(0,t.jsx)("div",{className:"mt-2 text-sm text-red-700",children:h})]})]})}),(0,t.jsx)("div",{className:"bg-white shadow rounded-lg",children:(0,t.jsx)("div",{className:"px-6 py-8",children:(0,t.jsx)(o.p,{onSubmit:g,isLoading:u,submitButtonText:"Create Donation Link"})})}),(0,t.jsxs)("div",{className:"mt-8 bg-blue-50 border border-blue-200 rounded-lg p-6",children:[(0,t.jsx)("h3",{className:"text-lg font-medium text-blue-900 mb-3",children:"\uD83D\uDCA1 Tips for a Great Donation Page"}),(0,t.jsxs)("ul",{className:"space-y-2 text-sm text-blue-800",children:[(0,t.jsxs)("li",{children:["• ",(0,t.jsx)("strong",{children:"Clear Title:"})," Make it obvious what the donations are for"]}),(0,t.jsxs)("li",{children:["• ",(0,t.jsx)("strong",{children:"Compelling Description:"})," Explain why people should support you"]}),(0,t.jsxs)("li",{children:["• ",(0,t.jsx)("strong",{children:"Custom URL:"}),' Choose something memorable and easy to share (e.g., "my-stream", "support-me")']}),(0,t.jsxs)("li",{children:["• ",(0,t.jsx)("strong",{children:"Theme Colors:"})," Match your brand or stream aesthetic"]}),(0,t.jsxs)("li",{children:["• ",(0,t.jsx)("strong",{children:"Anonymous Donations:"})," Allow anonymous giving to increase participation"]})]})]})]})}):(0,t.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("div",{className:"text-red-500 text-6xl mb-4",children:"\uD83D\uDEAB"}),(0,t.jsx)("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Access Denied"}),(0,t.jsx)("p",{className:"text-gray-600 mb-4",children:"You need to be logged in as a streamer to create donation links."}),(0,t.jsx)("button",{onClick:()=>e.push("/login"),className:"px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700",children:"Go to Login"})]})})}},46179:function(e,s,n){e.exports=n(70319)}},function(e){e.O(0,[4885,4952,189,1414,9788,7115,141,1744],function(){return e(e.s=67852)}),_N_E=e.O()}]);