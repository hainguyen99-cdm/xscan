(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6985],{5785:function(e,t,a){"use strict";a.d(t,{Z:function(){return u}});var s=a(58078);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),i=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,a)=>a?a.toUpperCase():t.toLowerCase()),n=e=>{let t=i(e);return t.charAt(0).toUpperCase()+t.slice(1)},l=(...e)=>e.filter((e,t,a)=>!!e&&""!==e.trim()&&a.indexOf(e)===t).join(" ").trim(),o=e=>{for(let t in e)if(t.startsWith("aria-")||"role"===t||"title"===t)return!0};/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var c={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let d=(0,s.forwardRef)(({color:e="currentColor",size:t=24,strokeWidth:a=2,absoluteStrokeWidth:r,className:i="",children:n,iconNode:d,...u},h)=>(0,s.createElement)("svg",{ref:h,...c,width:t,height:t,stroke:e,strokeWidth:r?24*Number(a)/Number(t):a,className:l("lucide",i),...!n&&!o(u)&&{"aria-hidden":"true"},...u},[...d.map(([e,t])=>(0,s.createElement)(e,t)),...Array.isArray(n)?n:[n]])),u=(e,t)=>{let a=(0,s.forwardRef)(({className:a,...i},o)=>(0,s.createElement)(d,{ref:o,iconNode:t,className:l(`lucide-${r(n(e))}`,`lucide-${e}`,a),...i}));return a.displayName=n(e),a}},93217:function(e,t,a){"use strict";a.d(t,{Z:function(){return s}});let s=(0,a(5785).Z)("bell",[["path",{d:"M10.268 21a2 2 0 0 0 3.464 0",key:"vwvbt9"}],["path",{d:"M3.262 15.326A1 1 0 0 0 4 17h16a1 1 0 0 0 .74-1.673C19.41 13.956 18 12.499 18 8A6 6 0 0 0 6 8c0 4.499-1.411 5.956-2.738 7.326",key:"11g9vi"}]])},775:function(e,t,a){"use strict";a.d(t,{Z:function(){return s}});let s=(0,a(5785).Z)("check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]])},7672:function(e,t,a){"use strict";a.d(t,{Z:function(){return s}});let s=(0,a(5785).Z)("mail",[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]])},71629:function(e,t,a){"use strict";a.d(t,{Z:function(){return s}});let s=(0,a(5785).Z)("save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]])},52183:function(e,t,a){"use strict";a.d(t,{Z:function(){return s}});let s=(0,a(5785).Z)("search",[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]])},71607:function(e,t,a){"use strict";a.d(t,{Z:function(){return s}});let s=(0,a(5785).Z)("shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]])},81874:function(e,t,a){"use strict";a.d(t,{Z:function(){return s}});let s=(0,a(5785).Z)("smartphone",[["rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",key:"1yt0o3"}],["path",{d:"M12 18h.01",key:"mhygvu"}]])},24390:function(e,t,a){"use strict";a.d(t,{Z:function(){return s}});let s=(0,a(5785).Z)("trash-2",[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]])},5032:function(e,t,a){"use strict";a.d(t,{Z:function(){return s}});let s=(0,a(5785).Z)("x",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]])},30021:function(e,t,a){Promise.resolve().then(a.bind(a,22127))},22127:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return g}});var s=a(37821),r=a(58078),i=a(52183),n=a(5032),l=a(93217),o=a(775),c=a(24390),d=a(61414),u=a(7672),h=a(81874),f=a(71607);let x=(0,a(5785).Z)("megaphone",[["path",{d:"M11 6a13 13 0 0 0 8.4-2.8A1 1 0 0 1 21 4v12a1 1 0 0 1-1.6.8A13 13 0 0 0 11 14H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2z",key:"q8bfy3"}],["path",{d:"M6 14a12 12 0 0 0 2.4 7.2 2 2 0 0 0 3.2-2.4A8 8 0 0 1 10 14",key:"1853fq"}],["path",{d:"M8 6v8",key:"15ugcq"}]]);var m=a(71629);function p(e){let{className:t=""}=e,[a,i]=(0,r.useState)({email:!0,inApp:!0,push:!1,donationConfirmations:!0,streamerUpdates:!0,securityAlerts:!0,marketing:!1}),[n,o]=(0,r.useState)(!1),[c,p]=(0,r.useState)(!1),{addNotification:g}=(0,d.HB)();(0,r.useEffect)(()=>{y()},[]);let y=async()=>{try{o(!0);let e=await fetch("/api/notifications/preferences");if(e.ok){let t=await e.json();i(t)}}catch(e){console.error("Failed to fetch notification preferences:",e),g({type:"error",title:"Error",message:"Failed to load notification preferences"})}finally{o(!1)}},b=async()=>{try{if(p(!0),(await fetch("/api/notifications/preferences",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)})).ok)g({type:"success",title:"Success",message:"Notification preferences updated successfully"});else throw Error("Failed to update preferences")}catch(e){console.error("Failed to update notification preferences:",e),g({type:"error",title:"Error",message:"Failed to update notification preferences"})}finally{p(!1)}},j=e=>{i(t=>({...t,[e]:!t[e]}))};return n?(0,s.jsx)("div",{className:"bg-white rounded-lg border border-gray-200 p-6 ".concat(t),children:(0,s.jsxs)("div",{className:"animate-pulse",children:[(0,s.jsx)("div",{className:"h-6 bg-gray-200 rounded w-1/3 mb-4"}),(0,s.jsx)("div",{className:"space-y-3",children:[...Array(6)].map((e,t)=>(0,s.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,s.jsx)("div",{className:"h-4 bg-gray-200 rounded w-4"}),(0,s.jsx)("div",{className:"h-4 bg-gray-200 rounded w-1/2"})]},t))})]})}):(0,s.jsxs)("div",{className:"bg-white rounded-lg border border-gray-200 ".concat(t),children:[(0,s.jsx)("div",{className:"px-6 py-4 border-b border-gray-200",children:(0,s.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,s.jsx)(l.Z,{className:"w-6 h-6 text-blue-600"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"Notification Preferences"}),(0,s.jsx)("p",{className:"text-sm text-gray-600",children:"Manage how you receive notifications"})]})]})}),(0,s.jsxs)("div",{className:"p-6 space-y-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h4",{className:"text-md font-medium text-gray-900 mb-4",children:"Delivery Methods"}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,s.jsx)(u.Z,{className:"w-5 h-5 text-gray-500"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm font-medium text-gray-900",children:"Email Notifications"}),(0,s.jsx)("p",{className:"text-xs text-gray-500",children:"Receive notifications via email"})]})]}),(0,s.jsxs)("label",{className:"relative inline-flex items-center cursor-pointer",children:[(0,s.jsx)("input",{type:"checkbox",checked:a.email,onChange:()=>j("email"),className:"sr-only peer"}),(0,s.jsx)("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"})]})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,s.jsx)(l.Z,{className:"w-5 h-5 text-gray-500"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm font-medium text-gray-900",children:"In-App Notifications"}),(0,s.jsx)("p",{className:"text-xs text-gray-500",children:"Show notifications in the app"})]})]}),(0,s.jsxs)("label",{className:"relative inline-flex items-center cursor-pointer",children:[(0,s.jsx)("input",{type:"checkbox",checked:a.inApp,onChange:()=>j("inApp"),className:"sr-only peer"}),(0,s.jsx)("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"})]})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,s.jsx)(h.Z,{className:"w-5 h-5 text-gray-500"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm font-medium text-gray-900",children:"Push Notifications"}),(0,s.jsx)("p",{className:"text-xs text-gray-500",children:"Receive push notifications on your device"})]})]}),(0,s.jsxs)("label",{className:"relative inline-flex items-center cursor-pointer",children:[(0,s.jsx)("input",{type:"checkbox",checked:a.push,onChange:()=>j("push"),className:"sr-only peer"}),(0,s.jsx)("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"})]})]})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h4",{className:"text-md font-medium text-gray-900 mb-4",children:"Notification Types"}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,s.jsx)("div",{className:"w-8 h-8 bg-green-100 rounded-full flex items-center justify-center",children:(0,s.jsx)("span",{className:"text-green-600 text-sm",children:"\uD83D\uDCB0"})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm font-medium text-gray-900",children:"Donation Confirmations"}),(0,s.jsx)("p",{className:"text-xs text-gray-500",children:"When your donations are processed"})]})]}),(0,s.jsxs)("label",{className:"relative inline-flex items-center cursor-pointer",children:[(0,s.jsx)("input",{type:"checkbox",checked:a.donationConfirmations,onChange:()=>j("donationConfirmations"),className:"sr-only peer"}),(0,s.jsx)("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"})]})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,s.jsx)("div",{className:"w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center",children:(0,s.jsx)("span",{className:"text-blue-600 text-sm",children:"\uD83D\uDCFA"})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm font-medium text-gray-900",children:"Streamer Updates"}),(0,s.jsx)("p",{className:"text-xs text-gray-500",children:"When your favorite streamers go live or post content"})]})]}),(0,s.jsxs)("label",{className:"relative inline-flex items-center cursor-pointer",children:[(0,s.jsx)("input",{type:"checkbox",checked:a.streamerUpdates,onChange:()=>j("streamerUpdates"),className:"sr-only peer"}),(0,s.jsx)("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"})]})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,s.jsx)("div",{className:"w-8 h-8 bg-red-100 rounded-full flex items-center justify-center",children:(0,s.jsx)(f.Z,{className:"w-4 h-4 text-red-600"})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm font-medium text-gray-900",children:"Security Alerts"}),(0,s.jsx)("p",{className:"text-xs text-gray-500",children:"Important security notifications about your account"})]})]}),(0,s.jsxs)("label",{className:"relative inline-flex items-center cursor-pointer",children:[(0,s.jsx)("input",{type:"checkbox",checked:a.securityAlerts,onChange:()=>j("securityAlerts"),className:"sr-only peer"}),(0,s.jsx)("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"})]})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,s.jsx)("div",{className:"w-8 h-8 bg-purple-100 rounded-full flex items-center justify-center",children:(0,s.jsx)(x,{className:"w-4 h-4 text-purple-600"})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm font-medium text-gray-900",children:"Marketing & Promotions"}),(0,s.jsx)("p",{className:"text-xs text-gray-500",children:"News, updates, and promotional content"})]})]}),(0,s.jsxs)("label",{className:"relative inline-flex items-center cursor-pointer",children:[(0,s.jsx)("input",{type:"checkbox",checked:a.marketing,onChange:()=>j("marketing"),className:"sr-only peer"}),(0,s.jsx)("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"})]})]})]})]}),(0,s.jsx)("div",{className:"pt-4 border-t border-gray-200",children:(0,s.jsx)("button",{onClick:b,disabled:c,className:"w-full bg-blue-600 text-white py-2 px-4 rounded-lg hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center space-x-2",children:c?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),(0,s.jsx)("span",{children:"Saving..."})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(m.Z,{className:"w-4 h-4"}),(0,s.jsx)("span",{children:"Save Preferences"})]})})}),(0,s.jsx)("div",{className:"text-xs text-gray-500 text-center",children:(0,s.jsx)("p",{children:"Security alerts will always be sent via email for your safety, regardless of your preferences."})})]})]})}function g(){let[e,t]=(0,r.useState)([]),[a,u]=(0,r.useState)([]),[h,f]=(0,r.useState)(!1),[x,m]=(0,r.useState)(!1),[g,y]=(0,r.useState)(""),[b,j]=(0,r.useState)("all"),[v,N]=(0,r.useState)("all"),[w,k]=(0,r.useState)(1),[A,S]=(0,r.useState)(!0),{addNotification:E}=(0,d.HB)();(0,r.useEffect)(()=>{C()},[w]),(0,r.useEffect)(()=>{D()},[e,g,b,v]);let C=async()=>{try{f(!0);let e=await fetch("/api/notifications?limit=20&offset=".concat((w-1)*20));if(e.ok){let a=await e.json();1===w?t(a.notifications||[]):t(e=>[...e,...a.notifications||[]]),S(20===(a.notifications||[]).length)}}catch(e){console.error("Failed to fetch notifications:",e),E({type:"error",title:"Error",message:"Failed to load notifications"})}finally{f(!1)}},D=()=>{let t=e;g&&(t=t.filter(e=>e.title.toLowerCase().includes(g.toLowerCase())||e.message.toLowerCase().includes(g.toLowerCase()))),"all"!==b&&(t=t.filter(e=>e.type===b)),"unread"===v?t=t.filter(e=>!e.isRead):"read"===v&&(t=t.filter(e=>e.isRead)),u(t)},Z=async e=>{try{(await fetch("/api/notifications/".concat(e,"/read"),{method:"PUT"})).ok&&t(t=>t.map(t=>t.id===e?{...t,isRead:!0}:t))}catch(e){console.error("Failed to mark notification as read:",e)}},L=async()=>{try{(await fetch("/api/notifications/mark-all-read",{method:"PUT"})).ok&&(t(e=>e.map(e=>({...e,isRead:!0}))),E({type:"success",title:"Success",message:"All notifications marked as read"}))}catch(e){console.error("Failed to mark all notifications as read:",e)}},M=async e=>{try{(await fetch("/api/notifications/".concat(e),{method:"DELETE"})).ok&&(t(t=>t.filter(t=>t.id!==e)),E({type:"success",title:"Success",message:"Notification deleted"}))}catch(e){console.error("Failed to delete notification:",e)}},T=e=>{switch(e){case"donation_confirmation":return"\uD83D\uDCB0";case"streamer_update":return"\uD83D\uDCFA";case"security_alert":return"\uD83D\uDD12";case"marketing":return"\uD83D\uDCE2";default:return"\uD83D\uDD14"}},U=e=>{let t=new Date(e),a=Math.floor((new Date().getTime()-t.getTime())/1e3);return a<60?"Just now":a<3600?"".concat(Math.floor(a/60),"m ago"):a<86400?"".concat(Math.floor(a/3600),"h ago"):a<2592e3?"".concat(Math.floor(a/86400),"d ago"):t.toLocaleDateString()},F=e.filter(e=>!e.isRead).length;return(0,s.jsx)("div",{className:"min-h-screen bg-gray-50",children:(0,s.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[(0,s.jsx)("div",{className:"mb-8",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Notifications"}),(0,s.jsx)("p",{className:"text-gray-600 mt-2",children:"Stay updated with your donation activity and streamer updates"})]}),(0,s.jsxs)("div",{className:"flex items-center space-x-4",children:[F>0&&(0,s.jsx)("button",{onClick:L,className:"text-sm text-blue-600 hover:text-blue-800 font-medium",children:"Mark all read"}),(0,s.jsx)("button",{onClick:()=>m(!x),className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors",children:"Preferences"})]})]})}),x&&(0,s.jsx)("div",{className:"mb-8",children:(0,s.jsx)(p,{})}),(0,s.jsx)("div",{className:"bg-white rounded-lg border border-gray-200 p-4 mb-6",children:(0,s.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4",children:[(0,s.jsxs)("div",{className:"flex-1 relative",children:[(0,s.jsx)(i.Z,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),(0,s.jsx)("input",{type:"text",placeholder:"Search notifications...",value:g,onChange:e=>y(e.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"}),g&&(0,s.jsx)("button",{onClick:()=>y(""),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600",children:(0,s.jsx)(n.Z,{className:"w-4 h-4"})})]}),(0,s.jsxs)("select",{value:b,onChange:e=>j(e.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[(0,s.jsx)("option",{value:"all",children:"All Types"}),(0,s.jsx)("option",{value:"donation_confirmation",children:"Donation Confirmations"}),(0,s.jsx)("option",{value:"streamer_update",children:"Streamer Updates"}),(0,s.jsx)("option",{value:"security_alert",children:"Security Alerts"}),(0,s.jsx)("option",{value:"marketing",children:"Marketing"})]}),(0,s.jsxs)("select",{value:v,onChange:e=>N(e.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[(0,s.jsx)("option",{value:"all",children:"All Status"}),(0,s.jsx)("option",{value:"unread",children:"Unread"}),(0,s.jsx)("option",{value:"read",children:"Read"})]})]})}),(0,s.jsxs)("div",{className:"bg-white rounded-lg border border-gray-200",children:[h&&1===w?(0,s.jsxs)("div",{className:"p-8 text-center",children:[(0,s.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto"}),(0,s.jsx)("p",{className:"text-gray-500 mt-2",children:"Loading notifications..."})]}):0===a.length?(0,s.jsxs)("div",{className:"p-8 text-center",children:[(0,s.jsx)(l.Z,{className:"w-12 h-12 mx-auto mb-3 text-gray-300"}),(0,s.jsx)("p",{className:"text-gray-500",children:"No notifications found"}),(0,s.jsx)("p",{className:"text-sm text-gray-400 mt-1",children:g||"all"!==b||"all"!==v?"Try adjusting your filters":"You'll see notifications here when you receive them"})]}):(0,s.jsx)("div",{className:"divide-y divide-gray-100",children:a.map(e=>(0,s.jsx)("div",{className:"p-6 hover:bg-gray-50 transition-colors ".concat(e.isRead?"":"bg-blue-50"),children:(0,s.jsxs)("div",{className:"flex items-start space-x-4",children:[(0,s.jsx)("div",{className:"flex-shrink-0 text-2xl",children:T(e.type)}),(0,s.jsx)("div",{className:"flex-1 min-w-0",children:(0,s.jsxs)("div",{className:"flex items-start justify-between",children:[(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-2 mb-1",children:[(0,s.jsx)("p",{className:"text-sm font-medium ".concat(e.isRead?"text-gray-700":"text-gray-900"),children:e.title}),!e.isRead&&(0,s.jsx)("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-blue-100 text-blue-800",children:"New"})]}),(0,s.jsx)("p",{className:"text-sm text-gray-600 mb-2",children:e.message}),(0,s.jsx)("p",{className:"text-xs text-gray-400",children:U(e.createdAt)})]}),(0,s.jsxs)("div",{className:"flex items-center space-x-2 ml-4",children:[!e.isRead&&(0,s.jsx)("button",{onClick:()=>Z(e.id),className:"p-2 text-gray-400 hover:text-green-600 hover:bg-green-50 rounded-lg transition-colors",title:"Mark as read",children:(0,s.jsx)(o.Z,{className:"w-4 h-4"})}),(0,s.jsx)("button",{onClick:()=>M(e.id),className:"p-2 text-gray-400 hover:text-red-600 hover:bg-red-50 rounded-lg transition-colors",title:"Delete notification",children:(0,s.jsx)(c.Z,{className:"w-4 h-4"})})]})]})})]})},e.id))}),A&&!h&&(0,s.jsx)("div",{className:"p-4 border-t border-gray-200 text-center",children:(0,s.jsx)("button",{onClick:()=>k(e=>e+1),className:"text-blue-600 hover:text-blue-800 font-medium",children:"Load more notifications"})}),h&&w>1&&(0,s.jsx)("div",{className:"p-4 border-t border-gray-200 text-center",children:(0,s.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-600 mx-auto"})})]}),(0,s.jsxs)("div",{className:"mt-6 grid grid-cols-1 sm:grid-cols-3 gap-4",children:[(0,s.jsx)("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)(l.Z,{className:"w-8 h-8 text-blue-600"}),(0,s.jsxs)("div",{className:"ml-3",children:[(0,s.jsx)("p",{className:"text-sm font-medium text-gray-900",children:"Total"}),(0,s.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:e.length})]})]})}),(0,s.jsx)("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)("div",{className:"w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center",children:(0,s.jsx)("span",{className:"text-blue-600 text-sm font-medium",children:"N"})}),(0,s.jsxs)("div",{className:"ml-3",children:[(0,s.jsx)("p",{className:"text-sm font-medium text-gray-900",children:"Unread"}),(0,s.jsx)("p",{className:"text-2xl font-bold text-blue-600",children:F})]})]})}),(0,s.jsx)("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)(o.Z,{className:"w-8 h-8 text-green-600"}),(0,s.jsxs)("div",{className:"ml-3",children:[(0,s.jsx)("p",{className:"text-sm font-medium text-gray-900",children:"Read"}),(0,s.jsx)("p",{className:"text-2xl font-bold text-green-600",children:e.length-F})]})]})})]})]})})}},61414:function(e,t,a){"use strict";a.d(t,{HB:function(){return c},qr:function(){return l},tN:function(){return o}});var s=a(8433),r=a(31421),i=a(30189);let n={user:null,isAuthenticated:!1,wallet:null,transactions:[],donations:[],donationLinks:[],recentDonations:[],obsSettings:null,dashboardStats:null,isLoading:!1,error:null},l=(0,s.Ue)()((0,r.mW)((0,r.tJ)((e,t)=>({...n,setUser:t=>e({user:t,isAuthenticated:!!t}),setAuthenticated:t=>e({isAuthenticated:t}),refreshUser:async()=>{try{let{isValid:t,user:a}=await (0,i.validateAuthToken)();t&&a&&e({user:a,isAuthenticated:!0})}catch(e){console.error("Failed to refresh user data:",e)}},updateUserRole:a=>{let{user:s}=t();s&&e({user:{...s,role:a}})},initializeAuth:async()=>{try{if(console.log("Initializing authentication..."),(0,i.pw)()){console.log("Token is expired, clearing auth state"),(0,i.H6)(),e({user:null,isAuthenticated:!1});return}let{isValid:t,user:a}=await (0,i.validateAuthToken)();console.log("Token validation result:",{isValid:t,user:a?"exists":"null"}),t&&a?(console.log("Setting authenticated user:",a.name),e({user:a,isAuthenticated:!0})):(console.log("Token invalid, clearing auth state"),(0,i.H6)(),e({user:null,isAuthenticated:!1}))}catch(t){console.error("Authentication initialization error:",t),(0,i.H6)(),e({user:null,isAuthenticated:!1})}},setWallet:t=>e({wallet:t}),updateWalletBalance:a=>{let{wallet:s}=t();s&&e({wallet:{...s,balance:s.balance+a}})},addTransaction:a=>{let{transactions:s}=t();e({transactions:[a,...s]})},setTransactions:t=>e({transactions:t}),addDonation:a=>{let{donations:s,recentDonations:r}=t();e({donations:[a,...s],recentDonations:[a,...r.slice(0,9)]})},setDonations:t=>e({donations:t}),addDonationLink:a=>{let{donationLinks:s}=t();e({donationLinks:[a,...s||[]]})},updateDonationLink:(a,s)=>{let{donationLinks:r}=t();e({donationLinks:(r||[]).map(e=>e.id===a?{...e,...s}:e)})},removeDonationLink:a=>{let{donationLinks:s}=t();e({donationLinks:(s||[]).filter(e=>e.id!==a)})},setDonationLinks:t=>e({donationLinks:t||[]}),setOBSSettings:t=>e({obsSettings:t}),updateOBSSettings:a=>{let{obsSettings:s}=t();s&&e({obsSettings:{...s,...a}})},setDashboardStats:t=>e({dashboardStats:t}),setLoading:t=>e({isLoading:t}),setError:t=>e({error:t}),clearError:()=>e({error:null}),reset:()=>e(n)}),{name:"auth-store",partialize:e=>({user:e.user,isAuthenticated:e.isAuthenticated,wallet:e.wallet,transactions:e.transactions,donations:e.donations,donationLinks:e.donationLinks,obsSettings:e.obsSettings})}))),o=(0,s.Ue)()((0,r.mW)((0,r.tJ)(e=>({isAuthenticating:!1,authError:null,login:async(t,a)=>{e({isAuthenticating:!0,authError:null});try{let e=await i.x1.auth.login(t,a);if(e&&e.access_token&&e.user)(0,i.uB)(e.access_token),l.getState().setUser(e.user),l.getState().setAuthenticated(!0);else throw Error("Invalid response format")}catch(a){var s,r;let t=(null===(r=a.response)||void 0===r?void 0:null===(s=r.data)||void 0===s?void 0:s.message)||a.message||"Login failed";throw e({authError:t}),Error(t)}finally{e({isAuthenticating:!1})}},register:async t=>{e({isAuthenticating:!0,authError:null});try{let e=t.name.trim().split(" "),a=e[0]||"",s=e.slice(1).join(" ")||"";if(a&&!s&&(s="User"),a.length<2)throw Error("First name must be at least 2 characters long");if(s.length<2)throw Error("Last name must be at least 2 characters long");let r={email:t.email,password:t.password,firstName:a,lastName:s,role:t.role},n=await i.x1.auth.register(r.email,r.password,r.firstName,r.lastName,r.role);if(n&&n.access_token&&n.user)(0,i.uB)(n.access_token),l.getState().setUser(n.user),l.getState().setAuthenticated(!0);else throw Error("Registration failed")}catch(r){var a,s;let t=(null===(s=r.response)||void 0===s?void 0:null===(a=s.data)||void 0===a?void 0:a.message)||r.message||"Registration failed";throw e({authError:t}),Error(t)}finally{e({isAuthenticating:!1})}},logout:()=>{i.x1.auth.logout().catch(console.error),(0,i.H6)(),l.getState().reset(),e({isAuthenticating:!1,authError:null})},forgotPassword:async t=>{e({isAuthenticating:!0,authError:null});try{await new Promise(e=>setTimeout(e,1e3))}catch(r){var a,s;let t=(null===(s=r.response)||void 0===s?void 0:null===(a=s.data)||void 0===a?void 0:a.message)||r.message||"Failed to send reset email";throw e({authError:t}),Error(t)}finally{e({isAuthenticating:!1})}},resetPassword:async(t,a)=>{e({isAuthenticating:!0,authError:null});try{await new Promise(e=>setTimeout(e,1e3))}catch(a){var s,r;let t=(null===(r=a.response)||void 0===r?void 0:null===(s=r.data)||void 0===s?void 0:s.message)||a.message||"Failed to reset password";throw e({authError:t}),Error(t)}finally{e({isAuthenticating:!1})}},verifyEmail:async t=>{e({isAuthenticating:!0,authError:null});try{await new Promise(e=>setTimeout(e,1e3))}catch(r){var a,s;let t=(null===(s=r.response)||void 0===s?void 0:null===(a=s.data)||void 0===a?void 0:a.message)||r.message||"Failed to verify email";throw e({authError:t}),Error(t)}finally{e({isAuthenticating:!1})}}}),{name:"auth-store",partialize:e=>({isAuthenticating:e.isAuthenticating,authError:e.authError})}))),c=(0,s.Ue)()((0,r.mW)((0,r.tJ)(e=>({sidebarOpen:!1,theme:"light",notifications:[],toggleSidebar:()=>e(e=>({sidebarOpen:!e.sidebarOpen})),setTheme:t=>e({theme:t}),addNotification:t=>e(e=>({notifications:[{...t,id:Date.now().toString(),timestamp:new Date},...e.notifications]})),removeNotification:t=>e(e=>({notifications:e.notifications.filter(e=>e.id!==t)})),clearNotifications:()=>e({notifications:[]})}),{name:"ui-store",partialize:e=>({theme:e.theme})})))}},function(e){e.O(0,[4885,4952,189,7115,141,1744],function(){return e(e.s=30021)}),_N_E=e.O()}]);