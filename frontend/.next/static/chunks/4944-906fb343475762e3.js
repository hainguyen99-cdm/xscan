"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4944],{64944:function(e,t,r){r.r(t),r.d(t,{Header:function(){return d}});var a=r(37821),i=r(58078),n=r(96871),o=r.n(n),s=r(46179),l=r(61414);function d(){var e;let[t,r]=(0,i.useState)(!1),[n,d]=(0,i.useState)(!1),{user:c,isAuthenticated:h}=(0,l.qr)(),{logout:u}=(0,l.tN)(),m=(0,s.usePathname)(),g=[{name:"Dashboard",href:"/dashboard"},{name:"Donate for Streamers",href:"/donate-for-streamers"},{name:"Wallet",href:"/wallet"},{name:"Reports",href:"/reports"}],x=[{name:"XScan Admin",href:"/admin"}],p=()=>{u(),d(!1)};return(0,a.jsxs)("header",{className:"bg-white/80 backdrop-blur-md shadow-lg border-b border-indigo-100/50 sticky top-0 z-50",children:[(0,a.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,a.jsxs)("div",{className:"flex justify-between items-center h-16",children:[(0,a.jsx)("div",{className:"flex items-center",children:(0,a.jsxs)(o(),{href:"/dashboard",className:"flex items-center group",children:[(0,a.jsx)("div",{className:"flex-shrink-0",children:(0,a.jsx)("div",{className:"h-10 w-10 bg-gradient-to-r from-indigo-600 to-cyan-500 rounded-xl flex items-center justify-center shadow-lg group-hover:shadow-indigo-200/50 transition-all duration-300 group-hover:scale-110",children:(0,a.jsx)("span",{className:"text-white font-bold text-lg",children:"D"})})}),(0,a.jsx)("div",{className:"ml-3",children:(0,a.jsx)("h1",{className:"text-xl font-bold bg-gradient-to-r from-indigo-600 to-cyan-600 bg-clip-text text-transparent",children:"DonationPlatform"})})]})}),(0,a.jsxs)("nav",{className:"hidden md:flex space-x-1",children:[g.map(e=>{let t=m===e.href;return(0,a.jsx)(o(),{href:e.href,className:"px-4 py-2 rounded-xl text-sm font-medium transition-all duration-200 ".concat(t?"text-white bg-gradient-to-r from-indigo-600 to-cyan-600 shadow-lg shadow-indigo-200/50":"text-gray-700 hover:text-indigo-600 hover:bg-gradient-to-r hover:from-indigo-50 hover:to-cyan-50"),children:e.name},e.name)}),h&&(null==c?void 0:c.role)==="admin"&&(0,a.jsx)("div",{className:"flex items-center space-x-1 ml-4 pl-4 border-l border-gray-200",children:x.map(e=>{let t=m===e.href;return(0,a.jsx)(o(),{href:e.href,className:"px-4 py-2 rounded-xl text-sm font-medium transition-all duration-200 ".concat(t?"text-white bg-gradient-to-r from-purple-600 to-pink-600 shadow-lg shadow-purple-200/50":"text-gray-700 hover:text-purple-600 hover:bg-gradient-to-r hover:from-purple-50 hover:to-pink-50"),children:e.name},e.name)})})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,a.jsxs)("button",{className:"p-2 text-gray-400 hover:text-indigo-600 relative transition-colors duration-200 hover:bg-indigo-50 rounded-xl",children:[(0,a.jsx)("span",{className:"sr-only",children:"View notifications"}),(0,a.jsxs)("svg",{className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 17h5l-5 5v-5z"}),(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 7h6m0 10v-3m-3 3h.01M9 17h.01M9 14h.01M12 14h.01M15 11h.01M12 11h.01M9 11h.01M7 21h10a2 2 0 002-2V5a2 2 0 00-2-2H7a2 2 0 00-2 2v14a2 2 0 002 2z"})]}),(0,a.jsx)("span",{className:"absolute top-1 right-1 block h-2.5 w-2.5 rounded-full bg-gradient-to-r from-red-400 to-pink-500 animate-pulse"})]}),h&&c?(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsxs)("button",{onClick:()=>d(!n),className:"flex items-center space-x-2 text-sm rounded-xl focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 hover:bg-indigo-50 p-2 transition-all duration-200",children:[c.profilePicture?(0,a.jsx)("img",{src:(e=c.profilePicture)?e.startsWith("http://")||e.startsWith("https://")?e:e.startsWith("/")?e:"/".concat(e):"",alt:"Profile",className:"h-9 w-9 rounded-xl object-cover shadow-lg",onError:e=>{let t=e.currentTarget,r=t.getAttribute("src")||"";if(r&&!r.startsWith("/")&&!r.startsWith("http")){t.src="/".concat(r);return}t.style.display="none"}}):(0,a.jsx)("div",{className:"h-9 w-9 rounded-xl bg-gradient-to-r from-indigo-600 to-cyan-500 flex items-center justify-center shadow-lg",children:(0,a.jsx)("span",{className:"text-white font-medium text-sm",children:(()=>{let e=c.firstName&&c.lastName?"".concat(c.firstName," ").concat(c.lastName).trim():c.name||"";return e.charAt(0)?e.charAt(0).toUpperCase():"U"})()})}),(0,a.jsx)("span",{className:"hidden md:block text-gray-700 font-medium",children:c.firstName&&c.lastName?"".concat(c.firstName," ").concat(c.lastName).trim():c.name||"User"}),(0,a.jsx)("svg",{className:"h-4 w-4 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),n&&(0,a.jsxs)("div",{className:"absolute right-0 mt-2 w-56 bg-white/95 backdrop-blur-md rounded-2xl shadow-xl py-2 z-50 border border-indigo-100/50",children:[(0,a.jsxs)("div",{className:"px-4 py-3 text-sm text-gray-700 border-b border-indigo-100/50",children:[(0,a.jsx)("div",{className:"font-semibold text-gray-900",children:c.firstName&&c.lastName?"".concat(c.firstName," ").concat(c.lastName).trim():c.name||"User"}),(0,a.jsx)("div",{className:"text-gray-500",children:c.email}),"admin"===c.role&&(0,a.jsx)("div",{className:"text-xs text-purple-600 font-medium bg-purple-50 px-2 py-1 rounded mt-1 inline-block",children:"Administrator"})]}),(0,a.jsx)(o(),{href:"/profile",className:"block px-4 py-2 text-sm text-gray-700 hover:bg-gradient-to-r hover:from-indigo-50 hover:to-cyan-50 transition-all duration-200",onClick:()=>d(!1),children:"Profile Settings"}),"admin"===c.role&&(0,a.jsx)(o(),{href:"/admin",className:"block px-4 py-2 text-sm text-gray-700 hover:bg-gradient-to-r hover:from-purple-50 hover:to-pink-50 transition-all duration-200",onClick:()=>d(!1),children:"XScan Admin"}),(0,a.jsx)("button",{onClick:p,className:"block w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gradient-to-r hover:from-red-50 hover:to-pink-50 hover:text-red-600 transition-all duration-200",children:"Sign out"})]})]}):(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,a.jsx)(o(),{href:"/login",className:"text-gray-700 hover:text-indigo-600 px-4 py-2 rounded-xl text-sm font-medium hover:bg-indigo-50 transition-all duration-200",children:"Sign in"}),(0,a.jsx)(o(),{href:"/register",className:"bg-gradient-to-r from-indigo-600 to-cyan-600 hover:from-indigo-700 hover:to-cyan-700 text-white px-5 py-2 rounded-xl text-sm font-medium transition-all duration-200 shadow-lg hover:shadow-xl transform hover:-translate-y-0.5",children:"Get Started"})]}),(0,a.jsxs)("button",{onClick:()=>r(!t),className:"md:hidden p-2 rounded-xl text-gray-400 hover:text-indigo-600 hover:bg-indigo-50 transition-all duration-200",children:[(0,a.jsx)("span",{className:"sr-only",children:"Open main menu"}),(0,a.jsx)("svg",{className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})]})]})]})}),t&&(0,a.jsx)("div",{className:"md:hidden",children:(0,a.jsxs)("div",{className:"px-2 pt-2 pb-3 space-y-1 sm:px-3 bg-white/95 backdrop-blur-md border-t border-indigo-100/50",children:[g.map(e=>{let t=m===e.href;return(0,a.jsx)(o(),{href:e.href,className:"block px-3 py-2 rounded-xl text-base font-medium transition-all duration-200 ".concat(t?"text-white bg-gradient-to-r from-indigo-600 to-cyan-600 shadow-lg":"text-gray-700 hover:text-indigo-600 hover:bg-gradient-to-r hover:from-indigo-50 hover:to-cyan-50"),onClick:()=>r(!1),children:e.name},e.name)}),h&&(null==c?void 0:c.role)==="admin"&&(0,a.jsx)(a.Fragment,{children:(0,a.jsxs)("div",{className:"border-t border-gray-200 pt-2 mt-2",children:[(0,a.jsx)("div",{className:"px-3 py-2 text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"Admin"}),x.map(e=>{let t=m===e.href;return(0,a.jsx)(o(),{href:e.href,className:"block px-3 py-2 rounded-xl text-base font-medium transition-all duration-200 ".concat(t?"text-white bg-gradient-to-r from-purple-600 to-pink-600 shadow-lg":"text-gray-700 hover:text-purple-600 hover:bg-gradient-to-r hover:from-purple-50 hover:to-pink-50"),onClick:()=>r(!1),children:e.name},e.name)})]})}),h&&(0,a.jsx)("button",{onClick:()=>{p(),r(!1)},className:"block w-full text-left px-3 py-2 rounded-xl text-base font-medium text-gray-700 hover:bg-gradient-to-r hover:from-red-50 hover:to-pink-50 hover:text-red-600 transition-all duration-200",children:"Sign out"})]})}),n&&(0,a.jsx)("div",{className:"fixed inset-0 z-40",onClick:()=>d(!1)})]})}},61414:function(e,t,r){r.d(t,{HB:function(){return d},qr:function(){return s},tN:function(){return l}});var a=r(8433),i=r(31421),n=r(30189);let o={user:null,isAuthenticated:!1,wallet:null,transactions:[],donations:[],donationLinks:[],recentDonations:[],obsSettings:null,dashboardStats:null,isLoading:!1,error:null},s=(0,a.Ue)()((0,i.mW)((0,i.tJ)((e,t)=>({...o,setUser:t=>e({user:t,isAuthenticated:!!t}),setAuthenticated:t=>e({isAuthenticated:t}),refreshUser:async()=>{try{let{isValid:t,user:r}=await (0,n.validateAuthToken)();t&&r&&e({user:r,isAuthenticated:!0})}catch(e){console.error("Failed to refresh user data:",e)}},updateUserRole:r=>{let{user:a}=t();a&&e({user:{...a,role:r}})},initializeAuth:async()=>{try{if(console.log("Initializing authentication..."),(0,n.pw)()){console.log("Token is expired, clearing auth state"),(0,n.H6)(),e({user:null,isAuthenticated:!1});return}let{isValid:t,user:r}=await (0,n.validateAuthToken)();console.log("Token validation result:",{isValid:t,user:r?"exists":"null"}),t&&r?(console.log("Setting authenticated user:",r.name),e({user:r,isAuthenticated:!0})):(console.log("Token invalid, clearing auth state"),(0,n.H6)(),e({user:null,isAuthenticated:!1}))}catch(t){console.error("Authentication initialization error:",t),(0,n.H6)(),e({user:null,isAuthenticated:!1})}},setWallet:t=>e({wallet:t}),updateWalletBalance:r=>{let{wallet:a}=t();a&&e({wallet:{...a,balance:a.balance+r}})},addTransaction:r=>{let{transactions:a}=t();e({transactions:[r,...a]})},setTransactions:t=>e({transactions:t}),addDonation:r=>{let{donations:a,recentDonations:i}=t();e({donations:[r,...a],recentDonations:[r,...i.slice(0,9)]})},setDonations:t=>e({donations:t}),addDonationLink:r=>{let{donationLinks:a}=t();e({donationLinks:[r,...a||[]]})},updateDonationLink:(r,a)=>{let{donationLinks:i}=t();e({donationLinks:(i||[]).map(e=>e.id===r?{...e,...a}:e)})},removeDonationLink:r=>{let{donationLinks:a}=t();e({donationLinks:(a||[]).filter(e=>e.id!==r)})},setDonationLinks:t=>e({donationLinks:t||[]}),setOBSSettings:t=>e({obsSettings:t}),updateOBSSettings:r=>{let{obsSettings:a}=t();a&&e({obsSettings:{...a,...r}})},setDashboardStats:t=>e({dashboardStats:t}),setLoading:t=>e({isLoading:t}),setError:t=>e({error:t}),clearError:()=>e({error:null}),reset:()=>e(o)}),{name:"auth-store",partialize:e=>({user:e.user,isAuthenticated:e.isAuthenticated,wallet:e.wallet,transactions:e.transactions,donations:e.donations,donationLinks:e.donationLinks,obsSettings:e.obsSettings})}))),l=(0,a.Ue)()((0,i.mW)((0,i.tJ)(e=>({isAuthenticating:!1,authError:null,login:async(t,r)=>{e({isAuthenticating:!0,authError:null});try{let e=await n.x1.auth.login(t,r);if(e&&e.access_token&&e.user)(0,n.uB)(e.access_token),s.getState().setUser(e.user),s.getState().setAuthenticated(!0);else throw Error("Invalid response format")}catch(r){var a,i;let t=(null===(i=r.response)||void 0===i?void 0:null===(a=i.data)||void 0===a?void 0:a.message)||r.message||"Login failed";throw e({authError:t}),Error(t)}finally{e({isAuthenticating:!1})}},register:async t=>{e({isAuthenticating:!0,authError:null});try{let e=t.name.trim().split(" "),r=e[0]||"",a=e.slice(1).join(" ")||"";if(r&&!a&&(a="User"),r.length<2)throw Error("First name must be at least 2 characters long");if(a.length<2)throw Error("Last name must be at least 2 characters long");let i={email:t.email,password:t.password,firstName:r,lastName:a,role:t.role},o=await n.x1.auth.register(i.email,i.password,i.firstName,i.lastName,i.role);if(o&&o.access_token&&o.user)(0,n.uB)(o.access_token),s.getState().setUser(o.user),s.getState().setAuthenticated(!0);else throw Error("Registration failed")}catch(i){var r,a;let t=(null===(a=i.response)||void 0===a?void 0:null===(r=a.data)||void 0===r?void 0:r.message)||i.message||"Registration failed";throw e({authError:t}),Error(t)}finally{e({isAuthenticating:!1})}},logout:()=>{n.x1.auth.logout().catch(console.error),(0,n.H6)(),s.getState().reset(),e({isAuthenticating:!1,authError:null})},forgotPassword:async t=>{e({isAuthenticating:!0,authError:null});try{await new Promise(e=>setTimeout(e,1e3))}catch(i){var r,a;let t=(null===(a=i.response)||void 0===a?void 0:null===(r=a.data)||void 0===r?void 0:r.message)||i.message||"Failed to send reset email";throw e({authError:t}),Error(t)}finally{e({isAuthenticating:!1})}},resetPassword:async(t,r)=>{e({isAuthenticating:!0,authError:null});try{await new Promise(e=>setTimeout(e,1e3))}catch(r){var a,i;let t=(null===(i=r.response)||void 0===i?void 0:null===(a=i.data)||void 0===a?void 0:a.message)||r.message||"Failed to reset password";throw e({authError:t}),Error(t)}finally{e({isAuthenticating:!1})}},verifyEmail:async t=>{e({isAuthenticating:!0,authError:null});try{await new Promise(e=>setTimeout(e,1e3))}catch(i){var r,a;let t=(null===(a=i.response)||void 0===a?void 0:null===(r=a.data)||void 0===r?void 0:r.message)||i.message||"Failed to verify email";throw e({authError:t}),Error(t)}finally{e({isAuthenticating:!1})}}}),{name:"auth-store",partialize:e=>({isAuthenticating:e.isAuthenticating,authError:e.authError})}))),d=(0,a.Ue)()((0,i.mW)((0,i.tJ)(e=>({sidebarOpen:!1,theme:"light",notifications:[],toggleSidebar:()=>e(e=>({sidebarOpen:!e.sidebarOpen})),setTheme:t=>e({theme:t}),addNotification:t=>e(e=>({notifications:[{...t,id:Date.now().toString(),timestamp:new Date},...e.notifications]})),removeNotification:t=>e(e=>({notifications:e.notifications.filter(e=>e.id!==t)})),clearNotifications:()=>e({notifications:[]})}),{name:"ui-store",partialize:e=>({theme:e.theme})})))}}]);