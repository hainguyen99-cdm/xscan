"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[189],{30189:function(t,a,e){e.d(a,{G$:function(){return m},H6:function(){return l},Nr:function(){return w},Xz:function(){return f},Zw:function(){return y},_f:function(){return g},hV:function(){return u},hi:function(){return r},pc:function(){return h},pw:function(){return p},uB:function(){return c},validateAuthToken:function(){return d},x1:function(){return o}});var s=e(91892);let n="auth-token",r=s.Z.create({baseURL:"http://14.225.211.248:3000",timeout:1e4,headers:{"Content-Type":"application/json"}});r.interceptors.request.use(t=>{let a=u();return a&&(t.headers.Authorization="Bearer ".concat(a)),t},t=>Promise.reject(t)),r.interceptors.response.use(t=>t,async t=>{var a;return(null===(a=t.response)||void 0===a?void 0:a.status)===401&&(console.log("401 Unauthorized - clearing token"),l(),delete r.defaults.headers.common.Authorization,["/login","/register","/forgot-password","/reset-password"].includes(window.location.pathname)||setTimeout(()=>{window.location.href="/login"},100)),Promise.reject(t)});let i={auth:{login:"/api/auth/login",register:"/api/auth/register",logout:"/api/auth/logout",refresh:"/api/auth/refresh",profile:"/api/auth/profile"},targets:{list:"/api/targets",create:"/api/targets",get:t=>"/api/targets/".concat(t),update:t=>"/api/targets/".concat(t),delete:t=>"/api/targets/".concat(t)},scans:{list:"/api/scans",create:"/api/scans",get:t=>"/api/scans/".concat(t),update:t=>"/api/scans/".concat(t),delete:t=>"/api/scans/".concat(t),start:t=>"/api/scans/".concat(t,"/start"),stop:t=>"/api/scans/".concat(t,"/stop"),results:t=>"/api/scans/".concat(t,"/results"),logs:t=>"/api/scans/".concat(t,"/logs")},projects:{list:"/api/projects",create:"/api/projects",get:t=>"/api/projects/".concat(t),update:t=>"/api/projects/".concat(t),delete:t=>"/api/projects/".concat(t),members:t=>"/api/projects/".concat(t,"/members")},users:{list:"/api/users",get:t=>"/api/users/".concat(t),update:t=>"/api/users/".concat(t),activate:t=>"/api/users/".concat(t,"/activate"),deactivate:t=>"/api/users/".concat(t,"/deactivate"),delete:t=>"/api/users/".concat(t),stats:"/api/users/stats",discoverStreamers:"/api/users/discover/streamers"},wallets:{create:"/api/wallets",get:t=>"/api/wallets/".concat(t),getByUser:t=>"/api/wallets/user/".concat(t),addFunds:t=>"/api/wallets/".concat(t,"/add-funds"),withdrawFunds:t=>"/api/wallets/".concat(t,"/withdraw-funds"),transferFunds:t=>"/api/wallets/".concat(t,"/transfer-funds"),getBalance:t=>"/api/wallets/".concat(t,"/balance"),getTransactions:t=>"/api/wallets/".concat(t,"/transactions"),getTransaction:(t,a)=>"/api/wallets/".concat(t,"/transactions/").concat(a),getTransactionsByType:(t,a)=>"/api/wallets/".concat(t,"/transactions/type/").concat(a),getTransactionStats:t=>"/api/wallets/".concat(t,"/transaction-stats"),processDonation:t=>"/api/wallets/".concat(t,"/donate"),processFee:t=>"/api/wallets/".concat(t,"/process-fee"),deactivate:t=>"/api/wallets/".concat(t,"/deactivate"),reactivate:t=>"/api/wallets/".concat(t,"/reactivate")},admin:{users:{list:"/api/admin/users",get:t=>"/api/admin/users/".concat(t),update:t=>"/api/admin/users/".concat(t),updateStatus:t=>"/api/admin/users/".concat(t,"/status"),verify:t=>"/api/admin/users/".concat(t,"/verify"),unverify:t=>"/api/admin/users/".concat(t,"/verify"),delete:t=>"/api/admin/users/".concat(t)}}},o={auth:{login:async(t,a)=>(await r.post(i.auth.login,{email:t,password:a})).data,register:async(t,a,e,s,n)=>(await r.post(i.auth.register,{email:t,password:a,firstName:e,lastName:s,role:n})).data,logout:async()=>(await r.post(i.auth.logout)).data,getProfile:async()=>(await r.get(i.auth.profile)).data},targets:{list:async t=>(await r.get(i.targets.list,{params:t})).data,create:async t=>(await r.post(i.targets.create,t)).data,get:async t=>(await r.get(i.targets.get(t))).data,update:async(t,a)=>(await r.put(i.targets.update(t),a)).data,delete:async t=>(await r.delete(i.targets.delete(t))).data},scans:{list:async t=>(await r.get(i.scans.list,{params:t})).data,create:async t=>(await r.post(i.scans.create,t)).data,get:async t=>(await r.get(i.scans.get(t))).data,update:async(t,a)=>(await r.put(i.scans.update(t),a)).data,delete:async t=>(await r.delete(i.scans.delete(t))).data},projects:{list:async()=>(await r.get(i.projects.list)).data,create:async t=>(await r.post(i.projects.create,t)).data,get:async t=>(await r.get(i.projects.get(t))).data,update:async(t,a)=>(await r.put(i.projects.update(t),a)).data,delete:async t=>(await r.delete(i.projects.delete(t))).data},users:{list:async()=>(await r.get(i.users.list)).data,get:async t=>(await r.get(i.users.get(t))).data,update:async(t,a)=>(await r.put(i.users.update(t),a)).data,activate:async t=>(await r.patch(i.users.activate(t))).data,deactivate:async t=>(await r.patch(i.users.deactivate(t))).data,delete:async t=>(await r.delete(i.users.delete(t))).data,stats:async()=>(await r.get(i.users.stats)).data,discoverStreamers:async t=>(await r.get(i.users.discoverStreamers,{params:t})).data},admin:{users:{list:async t=>(await r.get(i.admin.users.list,{params:t})).data,get:async t=>(await r.get(i.admin.users.get(t))).data,update:async(t,a)=>(await r.put(i.admin.users.update(t),a)).data,updateStatus:async(t,a,e)=>(await r.post(i.admin.users.updateStatus(t),{status:a,reason:e})).data,verify:async t=>(await r.post(i.admin.users.verify(t))).data,unverify:async t=>(await r.delete(i.admin.users.unverify(t))).data,delete:async t=>(await r.delete(i.admin.users.delete(t))).data}},wallets:{create:async t=>(await r.post(i.wallets.create,t)).data,getByUser:async t=>(await r.get(i.wallets.getByUser(t))).data,getTransactions:async t=>(await r.get(i.wallets.getTransactions(t))).data,addFunds:async(t,a)=>(await r.post(i.wallets.addFunds(t),a)).data,withdrawFunds:async(t,a)=>(await r.post(i.wallets.withdrawFunds(t),a)).data,transferFunds:async(t,a)=>(await r.post(i.wallets.transferFunds(t),a)).data}};function c(t){document.cookie="".concat(n,"=").concat(t,"; path=/; max-age=").concat(86400,"; SameSite=Lax"),localStorage.setItem(n,t)}function u(){{let t=document.cookie.split(";").find(t=>t.trim().startsWith("".concat(n,"=")));if(t){let a=t.split("=")[1];return localStorage.setItem(n,a),a}return localStorage.getItem(n)}}function l(){document.cookie="".concat(n,"=; path=/; expires=Thu, 01 Jan 1970 00:00:00 GMT"),localStorage.removeItem(n)}async function d(){try{console.log("Validating auth token...");let t=u();if(console.log("Stored token found:",!!t),!t)return console.log("No token found, returning invalid"),{isValid:!1,user:null};let a=await fetch("/api/auth/profile",{headers:{Authorization:"Bearer ".concat(t),"Content-Type":"application/json"}});if(!a.ok){if(401===a.status||403===a.status)return console.log("Authentication error, clearing token and returning invalid"),l(),{isValid:!1,user:null,isNetworkError:!1};return{isValid:!1,user:null,isNetworkError:!0}}let e=await a.json();if(e&&e.user)return console.log("Token validation successful, user:",e.user.username),{isValid:!0,user:e.user};return console.log("Token validation failed: no user data in response"),{isValid:!1,user:null}}catch(t){return console.error("Token validation error:",t),{isValid:!1,user:null,isNetworkError:!0}}}function p(){return!1}let w=async()=>{let t=await fetch("https://api.vietqr.io/v2/banks");if(!t.ok)throw Error("Failed to fetch bank list");return t.json()},g=async()=>{let t=u();if(!t)throw Error("Authentication required");let a=await fetch("/api/users/bank-accounts",{headers:{Authorization:"Bearer ".concat(t)}});if(!a.ok)throw Error("Failed to fetch bank accounts");let e=await a.json();return Array.isArray(e)?e:e.data||e.accounts||[]},h=async t=>{let a=u();if(!a)throw Error("Authentication required");let e=await fetch("/api/users/bank-accounts",{method:"POST",headers:{Authorization:"Bearer ".concat(a),"Content-Type":"application/json"},body:JSON.stringify(t)});if(!e.ok)throw Error((await e.json()).message||"Failed to create bank account");let s=await e.json();return s.data||s},f=async(t,a)=>{let e=u();if(!e)throw Error("Authentication required");let s=await fetch("/api/users/bank-accounts/".concat(t),{method:"PATCH",headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"},body:JSON.stringify(a)});if(!s.ok)throw Error((await s.json()).message||"Failed to update bank account");let n=await s.json();return n.data||n},y=async t=>{let a=u();if(!a)throw Error("Authentication required");let e=await fetch("/api/users/bank-accounts/".concat(t),{method:"DELETE",headers:{Authorization:"Bearer ".concat(a)}});if(!e.ok)throw Error((await e.json()).message||"Failed to delete bank account")},m=async t=>{let a=u();if(!a)throw Error("Authentication required");let e=await fetch("/api/users/bank-accounts/".concat(t,"/set-default"),{method:"PATCH",headers:{Authorization:"Bearer ".concat(a),"Content-Type":"application/json"}});if(!e.ok)throw Error((await e.json()).message||"Failed to set default bank account");let s=await e.json();return s.data||s}}}]);